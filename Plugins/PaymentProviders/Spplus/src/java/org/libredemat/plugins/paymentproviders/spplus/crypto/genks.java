/*--- formatted by Jindent 2.1, (www.c-lab.de/~jindent) ---*/

/**
 * Titre :
 * Description :
 * Copyright :    Copyright (c) 2003
 * Société :
 * @author
 * @version 1.0
 */
package org.libredemat.plugins.paymentproviders.spplus.crypto;
import org.libredemat.plugins.paymentproviders.spplus.utils.DoubleWord;

public class genks
{
    static DoubleWord[]	b1 =
    {
        new DoubleWord("30"), new DoubleWord("82"), new DoubleWord("06"),
        new DoubleWord("2F"), new DoubleWord("30"), new DoubleWord("82"),
        new DoubleWord("05"), new DoubleWord("17"), new DoubleWord("A0"),
        new DoubleWord("03"), new DoubleWord("02"), new DoubleWord("01"),
        new DoubleWord("02"), new DoubleWord("02"), new DoubleWord("01"),
        new DoubleWord("6A"), new DoubleWord("30"), new DoubleWord("0D"),
        new DoubleWord("06"), new DoubleWord("09"), new DoubleWord("2A"),
        new DoubleWord("86"), new DoubleWord("48"), new DoubleWord("86"),
        new DoubleWord("F7"), new DoubleWord("0D"), new DoubleWord("01"),
        new DoubleWord("01"), new DoubleWord("05"), new DoubleWord("05"),
        new DoubleWord("00"), new DoubleWord("30"), new DoubleWord("20"),
        new DoubleWord("31"), new DoubleWord("0B"), new DoubleWord("30"),
        new DoubleWord("09"), new DoubleWord("06"), new DoubleWord("03"),
        new DoubleWord("55"), new DoubleWord("04"), new DoubleWord("06"),
        new DoubleWord("13"), new DoubleWord("02"), new DoubleWord("55"),
        new DoubleWord("53"), new DoubleWord("31"), new DoubleWord("11"),
        new DoubleWord("30"), new DoubleWord("0F"), new DoubleWord("06"),
        new DoubleWord("03"), new DoubleWord("55"), new DoubleWord("04"),
        new DoubleWord("0A"), new DoubleWord("13"), new DoubleWord("08"),
        new DoubleWord("53"), new DoubleWord("45"), new DoubleWord("54"),
        new DoubleWord("20"), new DoubleWord("52"), new DoubleWord("6F"),
        new DoubleWord("6F"), new DoubleWord("74"), new DoubleWord("30"),
        new DoubleWord("1E"), new DoubleWord("17"), new DoubleWord("0D"),
        new DoubleWord("39"), new DoubleWord("37"), new DoubleWord("30"),
        new DoubleWord("37"), new DoubleWord("31"), new DoubleWord("35"),
        new DoubleWord("30"), new DoubleWord("30"), new DoubleWord("30"),
        new DoubleWord("30"), new DoubleWord("30"), new DoubleWord("30"),
        new DoubleWord("5A"), new DoubleWord("17"), new DoubleWord("0D"),
        new DoubleWord("30"), new DoubleWord("34"), new DoubleWord("30"),
        new DoubleWord("37"), new DoubleWord("31"), new DoubleWord("35"),
        new DoubleWord("30"), new DoubleWord("30"), new DoubleWord("30"),
        new DoubleWord("30"), new DoubleWord("30"), new DoubleWord("30"),
        new DoubleWord("5A"), new DoubleWord("30"), new DoubleWord("20"),
        new DoubleWord("31"), new DoubleWord("0B"), new DoubleWord("30"),
        new DoubleWord("09"), new DoubleWord("06"), new DoubleWord("03"),
        new DoubleWord("55"), new DoubleWord("04"), new DoubleWord("06"),
        new DoubleWord("13"), new DoubleWord("02"), new DoubleWord("55"),
        new DoubleWord("53"), new DoubleWord("31"), new DoubleWord("11"),
        new DoubleWord("30"), new DoubleWord("0F"), new DoubleWord("06"),
        new DoubleWord("03"), new DoubleWord("55"), new DoubleWord("04"),
        new DoubleWord("0A"), new DoubleWord("13"), new DoubleWord("08"),
        new DoubleWord("53"), new DoubleWord("45"), new DoubleWord("54"),
        new DoubleWord("20"), new DoubleWord("52")
    };
    static DoubleWord[]	b2 =
    {
        new DoubleWord("20"), new DoubleWord("00"), new DoubleWord("58"),
        new DoubleWord("D9"), new DoubleWord("F4"), new DoubleWord("40"),
        new DoubleWord("13"), new DoubleWord("18"), new DoubleWord("77"),
        new DoubleWord("0C"), new DoubleWord("B5"), new DoubleWord("04"),
        new DoubleWord("DE"), new DoubleWord("B7"), new DoubleWord("B6"),
        new DoubleWord("43"), new DoubleWord("8B"), new DoubleWord("A4"),
        new DoubleWord("CC"), new DoubleWord("36"), new DoubleWord("76"),
        new DoubleWord("79"), new DoubleWord("C5"), new DoubleWord("0B"),
        new DoubleWord("17"), new DoubleWord("CB"), new DoubleWord("7E"),
        new DoubleWord("88"), new DoubleWord("A1"), new DoubleWord("33"),
        new DoubleWord("B0"), new DoubleWord("D3"), new DoubleWord("34"),
        new DoubleWord("27"), new DoubleWord("BF"), new DoubleWord("3B"),
        new DoubleWord("61"), new DoubleWord("DA"), new DoubleWord("C5"),
        new DoubleWord("20"), new DoubleWord("EB"), new DoubleWord("F9"),
        new DoubleWord("94"), new DoubleWord("9A"), new DoubleWord("8B"),
        new DoubleWord("79"), new DoubleWord("B2"), new DoubleWord("A8"),
        new DoubleWord("8E"), new DoubleWord("CB"), new DoubleWord("C1"),
        new DoubleWord("D9"), new DoubleWord("94"), new DoubleWord("4A"),
        new DoubleWord("99"), new DoubleWord("66"), new DoubleWord("50"),
        new DoubleWord("55"), new DoubleWord("B2"), new DoubleWord("83"),
        new DoubleWord("28"), new DoubleWord("7D"), new DoubleWord("22"),
        new DoubleWord("3D"), new DoubleWord("EC"), new DoubleWord("DC"),
        new DoubleWord("A3"), new DoubleWord("E8"), new DoubleWord("39"),
        new DoubleWord("DB"), new DoubleWord("83"), new DoubleWord("54"),
        new DoubleWord("C9"), new DoubleWord("89"), new DoubleWord("A9"),
        new DoubleWord("DF"), new DoubleWord("59"), new DoubleWord("52"),
        new DoubleWord("9F"), new DoubleWord("7A"), new DoubleWord("EF"),
        new DoubleWord("7C"), new DoubleWord("11"), new DoubleWord("62"),
        new DoubleWord("52"), new DoubleWord("EC"), new DoubleWord("E6"),
        new DoubleWord("67"), new DoubleWord("BA"), new DoubleWord("3D"),
        new DoubleWord("EA"), new DoubleWord("AB"), new DoubleWord("47"),
        new DoubleWord("DB"), new DoubleWord("E4"), new DoubleWord("F4"),
        new DoubleWord("1F"), new DoubleWord("73"), new DoubleWord("C3"),
        new DoubleWord("3D"), new DoubleWord("EC"), new DoubleWord("7E"),
        new DoubleWord("84"), new DoubleWord("7D"), new DoubleWord("2F"),
        new DoubleWord("29"), new DoubleWord("FE"), new DoubleWord("6C"),
        new DoubleWord("17"), new DoubleWord("3F"), new DoubleWord("75"),
        new DoubleWord("6D"), new DoubleWord("56"), new DoubleWord("6E"),
        new DoubleWord("C0"), new DoubleWord("4E"), new DoubleWord("B5"),
        new DoubleWord("BF"), new DoubleWord("2A"), new DoubleWord("20"),
        new DoubleWord("8A"), new DoubleWord("E4"), new DoubleWord("57"),
        new DoubleWord("AE"), new DoubleWord("C0"), new DoubleWord("2E"),
        new DoubleWord("68"), new DoubleWord("C9")
    };

    /*
     * --------------------------------------------------------------
     * GenKs()
     * --------------------------------------------------------------
     */

    /**
     * Method declaration
     *
     *
     * @param sh1
     *
     * @return
     *
     * @see
     */
    public static int[] GenKs(sha sh1)
    {
        int			i;
        DoubleWord[]   c = new DoubleWord[20];
        DoubleWord[]   b3 = new DoubleWord[128];
        int[]		b4 = new int[128];

        for (i = 0; i < 128; i++)
        {
            b3[i] = b1[i];
        }

        for (i = 0; i < 128; i++)
        {
            b3[i] = b3[i].xor(b2[i]);
        }

        for (i = 0; i < 128; i++)
        {
            b4[i] = b3[i].toInt();
        }

        int[]   outkey = sh1.proceed(b4, 128);
        int[]   output = new int[8];

        for (i = 0; i < 8; i++)
        {
            output[i] = outkey[i];
        }

        return (output);
    }

}
// End of class genks


/*--- formatting done in "Sun Java Convention" style on 04-10-2003 ---*/
