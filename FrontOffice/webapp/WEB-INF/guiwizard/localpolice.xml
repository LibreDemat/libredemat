<?xml version="1.0" encoding="UTF-8"?>
<cvqprocess xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="processes.xsd">
	<processes group="localpolice" caption="Sécurité" order="7">
 	
		<process name="eHolidaySecurity" caption="S&#233;curit&#233; vacances" time="5">
			<title>S&#233;curit&#233; vacances</title>
			<confirm name="familyHome" check="hasAuthorizedSubjects">Vous n'avez aucune personne à inscrire.</confirm>
			<package>fr.cg95.cvq.fo.localpolice</package>
			<persistence>fr.cg95.cvq.fo.localpolice.HolidaySecurityPersistence</persistence>
			<information label="Règlement Sécurité vacances.">txt/ReglementSecu.txt</information>

			<!-- Subject -->
	 		<stage name="Subject" caption="Personne à inscrire">
				<title>Personne à inscrire</title>
				<info>Selection de la personne</info>

				<confirm name="changed" check="state">Vos modifications éventuelles seront perdu ! Voulez-vous continuer ?</confirm>
				<confirm name="cancel">Attention ! les données de la demande n'ont pas été enregistrées</confirm>
				<confirm name="delete">Voules-vous vraiement supprimer les informations sur la demande</confirm>
				<confirm name="terminate">Voulez-vous vraiement abandonner</confirm>
				<confirm name="continue" check="">Vous devez selectionner une personne</confirm>

				<default>default</default>

				<previous confirm="terminate">endProcess</previous>
				<next confirm="continue" />

				<state name="default">
					<title>Le demandeur</title>
					<form>/localpolice/subject/default</form>
				</state>
				<state name="subject">
					<title>Le demandeur</title>
					<form>/localpolice/subject/subject</form>
					<button confirm="cancel" action="resetProcess" transition="default">Annuler Saisie</button>
					<button default="true" script="processSubmit" action="" transition="display">Enregistrer</button>
				</state>
				<state name="display" mode="static">
					<title>Le demandeur</title>
					<form>/localpolice/subject/display</form>
					<button confirm="delete" action="resetProcess" transition="default">Supprimer</button>
					<button action="" transition="subject">Modifier</button>
				</state>
				<select name="familyHome" property="selectionListWithoutCurrent" state="default" >
					<title>Adulte(s) du compte</title>
					<display type="people"/>
					<display name="firstName"/>
					<display name="lastName"  initial="true"/>
					<action confirm="changed" parameter="index" transition="subject">createRequest</action>
				</select>
				<select name="familyHome" property="individualToRegister" state="all">
					<title>Adulte à inscrire</title>
					<display type="people"/>
					<display name="firstName"/>
					<display name="lastName"  initial="true"/>
					<action parameter="index" transition="display">processStage</action>
				</select>
			</stage>

			<!-- document -->
		 	<stage ref="Documents"/>

			<!-- Date -->

			<stage name="Absencedate" caption="Dates de l'absence" stagemenu="display">
				<title>Date de l'absence</title>
				<info>Date de début et de fin de l'absence</info>
				<confirm name="cancel">Attention ! Les données de la demande n'ont pas été enregistrées ! Voulez-vous quand même annuler la saisie ?</confirm>
				<default>default</default>
				<next script="processSubmit" action=""/>

				<state name="default" change="confirm">
					<title>Date de début et de fin d'absence</title>
					<form>/localpolice/absencedate/absencedate</form>
					<button confirm="cancel" action="" transition="default">Annuler Saisie</button>
					<button default="true" script="processSubmit" action="next">Enregistrer</button>
				</state>
			</stage>

			<!-- réglement -->

			<stage name="Rules" caption="Réglement" stagemenu="display">
				<title>Réglement du service</title>
				<info>Réglement du service à souscrire</info>
				<confirm name="cancel">Attention ! Les données de la demande n'ont pas été enregistrées ! Voulez-vous quand même annuler la saisie ?</confirm>
				<default>default</default>
				<next script="processSubmit" action=""/>

				<state name="default" change="confirm">
					<title>Souscription au réglement</title>
					<form>/common/rules/rules</form>
					<form>/localpolice/rules/authorisation</form>
					<button confirm="cancel" action="" transition="default">Annuler Saisie</button>
					<button default="true" script="processSubmit" action="next">Enregistrer</button>
				</state>
			</stage>

			<!-- telephone d'alerte -->

			<stage name="Alertphone" caption="Téléphone de contact" stagemenu="display">
				<title>Téléphone de contact d'alerte</title>
				<info>Téléphone de liaison en cas d'alerte </info>
				<confirm name="cancel">Attention ! Les données de la demande n'ont pas été enregistrées ! Voulez-vous quand même annuler la saisie ?</confirm>
				<default>default</default>
				<next script="processSubmit" action=""/>

				<state name="default" change="confirm">
					<title>Téléphone d'alerte</title>
					<form>/localpolice/alertphone/alertphone</form>
					<button confirm="cancel" action="" transition="default">Annuler Saisie</button>
					<button default="true" script="processSubmit" action="next">Enregistrer</button>
				</state>
			</stage>

			<!-- Personne à contacter -->

			<stage name="Othercontact" caption="Autre contact" stagemenu="display" required="false">
				<title>Personne à contacter</title>
				<info>Personne à contacter en cas d'alerte</info>
				<confirm name="cancel">Attention ! Les données de la demande n'ont pas été enregistrées ! Voulez-vous quand même annuler la saisie ?</confirm>
				<default>default</default>
				<next script="processSubmit" action=""/>

				<state name="default" change="confirm">
					<title>Personne à contacter</title>
					<form>/localpolice/othercontact/othercontact</form>
					<button confirm="cancel" action="" transition="default">Annuler Saisie</button>
					<button default="true" script="processSubmit" action="next">Enregistrer</button>
				</state>
			</stage>

			<!-- Info complémentaire -->

			<stage name="Securityfacility" caption="Information complémentaire" stagemenu="display" required="false">
				<title>Info complémentaire</title>
				<info>Information sur la présence d'une alarme ou d'un éclairage automatique</info>
				<confirm name="cancel">Attention ! Les données de la demande n'ont pas été enregistrées ! Voulez-vous quand même annuler la saisie ?</confirm>
				<default>default</default>
				<next script="processSubmit" action=""/>

				<state name="default">
					<title>Info complémentaire</title>
					<form>/localpolice/securityfacility/securityfacility</form>
					<button confirm="cancel" action="" transition="default">Annuler Saisie</button>
					<button default="true" script="processSubmit" action="next">Enregistrer</button>
				</state>
			</stage>

			<!-- Validation -->

			<stage name="Validation" caption="Validation" stagemenu="display">
				<title>Validation</title>
				<info>Résumé des informations fournies. A valider pour la création de votre demande</info>

				<default>summary</default>

				<next>false</next>

				<state name="summary" mode="static">
					<form>/common/validation/requester</form>
					<form>/localpolice/validation/summary</form>
					<button type="quit" script="cancelRequest()">Annuler la demande</button>
					<button type="next" default="true" script="processSubmit" action="" transition="validation">Page suivante</button>
				</state>
				<state name="validation">
					<form>/common/validation/validation</form>
					<button type="quit" script="cancelRequest()">Annuler la demande</button>
					<button type="save" script="validateRequest()">Enregistrer</button>
				</state>

				<state name="trace">
					<form>/common/validation/trace</form>
					<button type="quit" script="cancelRequest()">Annuler la demande</button>
					<button type="save" script="validateRequest()">Enregistrer</button>
				</state>

				<state name="print" buttonArea="none" mode="noreturn">
					<form>/common/validation/print</form>
				</state>
			</stage>
		</process>

	</processes>
</cvqprocess>
