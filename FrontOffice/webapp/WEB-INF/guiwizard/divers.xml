<?xml version="1.0" encoding="UTF-8" ?>

<cvqprocess xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	 xsi:noNamespaceSchemaLocation="processes.xsd" >

  <processes group="divers">
	<!-- ****** REGLEMENT DE FACTURES ************-->
	<process name="eInvoice" caption="Factures">
		<title>Règlement de factures</title>
		<package>fr.cg95.cvq.fo.invoice</package>
        <persistence>fr.cg95.cvq.fo.invoice.PaymentPersistence</persistence>

	    <!-- ******************* DEMANDEUR *********************-->
		<stage ref="Requester" />
		
		<stage name="Invoices" caption="Factures">
			<title>Factures à régler</title>
			<info>/invoice/invoices/information</info>

			<confirm name="cancel">Attention ! Les données de la demande n'ont pas été enregistrées ! Voulez-vous quand même annuler la saisie ?</confirm>
			<confirm name="delete">Voulez-vous vraiment supprimer les informations sur la facture sélectionner?</confirm>
			<confirm name="continue" check="">Vous devez enregistrer la page avant de passer à l'étape suivante</confirm>
			<confirm name="terminate">Voulez-vous vraiment abandonner ?</confirm>
			<confirm name="changed" check="state">Vos modifications éventuelles seront perdu ! Voulez-vous continuer ?</confirm>

			<default>default</default>
				
			<next script="processSubmit" action=""/>

			<state name="default">
				<title>Ajouter une facture</title>
				<form>/invoice/invoices/default</form>
			</state>
			
			<state name="display">
				<title>Consulter une facture</title>
				<form>/invoice/invoices/display</form>
				<button confirm="delete" action="del" transition="default">Supprimer</button>
				<button transition="invoice" action="">Modifier</button>
			</state>
			
			<state name="invoice" change="confirm">
				<title>Ajouter une facture</title>
				<form>/invoice/invoices/invoice</form>
				<button confirm="cancel" action="" transition="default">Annuler Saisie</button>
				<button default="true" script="processSubmit" action="save" transition="display">Enregistrer</button>
			</state>
											
			<select name="fr.cg95.cvq.fo.common.Request" property="list(invoice)" >
				<title>Facture à régler</title>
				<display name="invoiceReference"/>
				<action confirm="changed" parameter="index" transition="display">get</action> 
				<button confirm="changed" action="new" transition="invoice">Ajouter une facture</button>
			</select>
		</stage>

		<stage ref="Documents"/>
		
		<stage name="Rules" caption="Règlementaire" >
			<title>Règlementaire</title>
			<info>/invoice/rules/information</info>
			<default>default</default>

			<next script="processSubmit" action="" />
			
			<state name="default">
				<title>Règlementaire</title>
				<form>/invoice/rules/authorisation</form>
				<button default="true" script="processSubmit" action="next">Enregistrer</button>
			</state>
		</stage>
			
		<!-- ******************* VALIDATION *********************-->	
		<stage name="Validation" caption="Validation" >
			<title>Validation et fin</title>
			<info>/invoice/validation/information</info>
			<default>validation</default>

			<next>false</next>
			
			<state name="validation">
				<title>Validation</title>
				<form>/common/validation/validation</form>
				<form>/invoice/validation/summary</form>
				<form>/common/validation/documents</form>
			</state>

			<state name="print">
				<title>Validation</title>
				<form>/common/validation/print</form>
				<form>/invoice/validation/summary</form>
				<form>/common/validation/documents</form>
			</state>
		</stage>
		
	</process>
  </processes>		
</cvqprocess>
	