<?xml version="1.0" encoding="UTF-8" ?>

<cvq xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
	 xmlns:xi="http://www.w3.org/2001/XInclude"
	 xsi:noNamespaceSchemaLocation="processes.xsd" >

  <globals>
	<session data="familyHome" type="fr.cg95.cvq.fo.common.FamilyHome" />

<!-- the timeout defined here should reflect the timeout defined in the web.xml -->
	<timeout delay="10" href="closeSession.do" />

	<help>http://aidecartevaloise.valdoise.fr</help>
	<style>css/frame.css</style>
	<style>css/form.css</style>
	<style>css/streamer.css</style>
	<style>css/button.css</style>
	<style>css/text.css</style>
	<style>css/div.css</style>
	<style>css/span.css</style>
	<style>css/select.css</style>
	<style>css/display-tag.css</style>
	<style>css/label.css</style>
	<style>css/p.css</style>
	<style>css/formular.css</style>
	<style>css/teleproc.css</style>
	<script src="./js/date.js" />
	<script src="./js/file.js" />
	<script src="./js/process.js" />
	<script src="./js/justification.js" />
	<script src="./js/utils.js" />
  </globals>
  
<!-- **************** PARAMETRES DES SITES ******************* -->
  <sites>
	<site domain="cartevaloise.valdoise.fr" default="true">
		<application>FrontOffice</application>
		<title>Conseil Général du Val d'Oise</title>
		<banner>/town/cg95</banner>
		<home>/managerWizard.do</home>
		<logout>/managerWizard.do</logout>
<!--		<colorset header="#175495" button="#7593b9" background="#fbe38b" /> blue blue orange -->
<!--		<colorset header="#fd351f" button="#f4a11f" background="#fbe38b" /> rouge orange orange -->
<!--		<colorset header="#175495" button="#7c0b11" background="#fbe38b" /> blue bordeau orange -->
		<colorset header="#175495" button="#7593b9" streamer="#f4a11f" background="#fbe38b" />
	</site>

	<site domain="cartevaloise.ville-louvres.fr">
		<application>FrontOffice</application>
		<title>Louvres</title>
		<banner>/town/louvres</banner>
		<home>/managerWizard.do</home>
		<logout>/managerWizard.do</logout>
		<colorset header="#e29056" button="#f7b700" background="#fffabc" />
	</site>

	<site domain="cartevaloise.ville-parmain.fr">
		<application>FrontOffice</application>
		<title>Parmain</title>
		<banner>/town/parmain</banner>
		<home>/managerWizard.do</home>
		<logout>/managerWizard.do</logout>
		<colorset header="#3f6f0f" button="#458a00" background="#d1e498" />
	</site>

	<site domain="cartevaloise.ville-franconville.fr">
		<application>FrontOffice</application>
		<title>Franconville</title>
		<banner>/town/franconville</banner>
		<home>/managerWizard.do</home>
		<logout>/managerWizard.do</logout>
		<colorset header="#3c4faa" button="#4d61c1" background="#d2e1ff" />
	</site>

	<site domain="cartevaloise.ville-saintouenlaumone.fr">
		<application>FrontOffice</application>
		<title>Saint Ouen l'Aumône</title>
		<banner>/town/SOA</banner>
		<home>/managerWizard.do</home>
		<logout>/managerWizard.do</logout>
		<colorset header="#388B75" button="#34aa88" background="#dbf0eb" />
	</site>
  </sites>
  
<!--****************** PROCESSUS DEMANDE CARTE VALOISE *****************-->
  <processes>
	<process name="eFamily" extends="eCitizen">
		<title>Modification de Foyer</title>
		<home>/citizen_updateHomeFolderAction.do</home>
		<override stage="Justificatifs" />
	</process>
	
	<process name="eCitizen">
		<title>Demande de Cartevaloise</title>
		<home>/closeSession.do</home>
		<data name="cardRequest" access="cardRequest" />
		
		<!-- *******************INSCRIPTION ADULTE *********************-->
		<stage caption="Adultes" >
			<title>Identité des adultes de votre foyer</title>
			<info>/citizen/step0/information</info>
			<confirm name="changed">Vos modifications éventuelles ou votre enregistrement sera perdu ! Voulez-vous continuer ?</confirm>
			<default>citizen_defaultAdultAction</default>
			<previous>begin()</previous>
			<next>verifyResponsible()</next>

			<state name="citizen_defaultAdultAction">
				<title>Ajouter un adulte</title>
				<form>/citizen/step0/default</form>
			</state>
			
			<state name="citizen_showAdultAction">
				<title>Consulter un adulte</title>
				<form>/citizen/step0/shownFirst</form>
				<button script="confirmDelete()" align="left">Supprimer</button>
				<button action="citizen_editAdultAction" align="center">Modifier</button>
				<button action="citizen_showSecondPartAdultAction" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_showSecondPartAdultAction">
				<title>Consulter un adulte</title>
				<form>/citizen/step0/shownSecond</form>
				<button action="citizen_showAdultAction" align="left" width="142" arrow="left">Page précédente</button>
			</state>

			<state name="citizen_saveFirstPartAdultAction" change="confirm">
				<title>Ajouter un adulte</title>
				<form>/citizen/step0/editedSecond</form>
				<button script="validateAndReturn(adultForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="adultFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(adultForm)" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_saveSecondPartAdultAction" change="confirm">
				<title>Ajouter un adulte</title>
				<form>/citizen/step0/editedThird</form>
				<button script="validateAndReturn(adultForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="adultFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(adultForm)" align="right">Enregistrer</button>
			</state>
			
			<state name="citizen_saveThirdPartAdultAction">
				<title>Adulte enregistré</title>
				<form>/citizen/step0/shownFirst</form>
				<button script="confirmDelete()" align="left">Supprimer</button>
				<button action="citizen_editAdultAction" align="center">Modifier</button>
				<button action="citizen_showSecondPartAdultAction" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_showSecondPartSavedAdultAction">
				<title>Adulte enregistré</title>
				<form>/citizen/step0/shownSecond</form>
				<button action="citizen_showAdultAction" align="left" width="142" arrow="left">Page précédente</button>
			</state>

			<state name="citizen_returnFromSecondPartAdultAction" change="confirm">
				<title>Ajouter un adulte</title>
				<form>/citizen/step0/editedFirst</form>
				<button script="adultFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(adultForm)" align="right">Page suivante</button>
			</state>

			<state name="citizen_returnFromThirdPartAdultAction" change="confirm">
				<title>Ajouter un adulte</title>
				<form>/citizen/step0/editedSecond</form>
				<button script="validateAndReturn(adultForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="adultFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(adultForm)" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_removeAdultAction">
				<title>Ajouter un adulte</title>
				<form>/citizen/step0/default</form>
			</state>
			
			<state name="citizen_addAdultAction" change="confirm">
				<title>Ajouter un adulte</title>
				<form>/citizen/step0/editedFirst</form>
				<button script="adultFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(adultForm)" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_editAdultAction" change="confirm">
				<title>Modifier un adulte</title>
				<form>/citizen/step0/editedFirst</form>
				<button script="adultFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(adultForm)" align="right">Page suivante</button>
			</state>

			<select name="familyHome" property="adults" >
				<title>Les adultes du foyer</title>
				<empty>Aucun adulte saisi</empty>
				<display name="firstName"/>
				<display name="lastName" initial="true"/>
				<action confirm="changed" parameter="index">citizen_showAdultAction</action> 
				<button script="addAdult()">Ajouter un adulte</button>
			</select>			
		</stage>
		
		<!--********************* INSCRIPTION ENFANT ************************-->
		<stage caption="Enfants" >
			<title>Identité des enfants de votre foyer</title>
			<info>/citizen/step1/information</info>
			<confirm name="changed">Vos modifications éventuelles ou votre enregistrement sera perdu ! Voulez-vous continuer ?</confirm>
			<default>citizen_defaultChildAction</default>
            <next>verifyLegacyResponsible()</next>

			<state name="citizen_defaultChildAction">
				<title>Ajouter un enfant</title>
				<form>/citizen/step1/default</form>
			</state>

			<state name="citizen_addChildAction">
				<title>Ajouter un enfant</title>
				<form>/citizen/step1/edited</form>
				<button script="childFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(childForm)">Page suivante</button>
			</state>
			
			<state name="citizen_editChildAction">
				<title>Modifier un enfant</title>
				<form>/citizen/step1/edited</form>
				<button script="childFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(childForm)" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_showLegacyResponsibleAction">
				<title>Choisir un responsable</title>
				<form>/citizen/step1/chooseLegacyResponsible</form>
				<button script="validateAndAddLegacyResponsible(responsibleForm)" align="right" valign="top">Ajouter Responsable</button>
				<button script="validateAndReturn(responsibleForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="childFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Enregistrer</button>				
			</state>
			
			<state name="citizen_chooseLegacyResponsibleAction">
				<title>Enfant enregistré</title>
				<form>/citizen/step1/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="citizen_editChildAction" align="center-right">Modifier</button>
			</state>
			
			<state name="citizen_showChildAction">
				<title>Consulter un enfant</title>
				<form>/citizen/step1/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="citizen_editChildAction" align="center-right">Modifier</button>
			</state>		
			
			<state name="citizen_addLegacyResponsibleAction">
				<title>Ajouter un responsable légal</title>
				<form>/citizen/step1/editedFirstPartLegacyResponsible</form>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Pages suivante</button>
			</state>
						
			<state name="citizen_saveFirstPartLegacyResponsibleAction">
				<title>Ajouter un responsable légal</title>
				<form>/citizen/step1/editedSecondPartLegacyResponsible</form>
				<button script="validateAndReturn(responsibleForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Page suivante</button>
			</state>			
			
			<state name="citizen_saveSecondPartLegacyResponsibleAction">
				<title>Ajouter un responsable légal</title>
				<form>/citizen/step1/editedThirdPartLegacyResponsible</form>
				<button script="validateAndReturn(responsibleForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Enregistrer</button>
			</state>

			<state name="citizen_returnFromSecondPartLegacyResponsibleAction">
				<title>Ajouter un responsable légal</title>
				<form>/citizen/step1/editedFirstPartLegacyResponsible</form>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Page suivante</button>
			</state>

			<state name="citizen_saveThirdPartLegacyResponsibleAction">
				<title>Enfant enregistré</title>
				<form>/citizen/step1/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="citizen_editChildAction" align="center-right">Modifier</button>
			</state>
           
			<state name="citizen_returnFromThirdPartLegacyResponsibleAction">
				<title>Ajouter un responsable légal</title>
				<form>/citizen/step1/editedSecondPartLegacyResponsible</form>
				<button script="validateAndReturn(responsibleForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_showFirstPartLegacyResponsibleAction">
				<title>Consulter un responsable légal</title>
				<form>/citizen/step1/shownFirstPartLegacyResponsible</form>
				<button script="confirmDelete()" align="left">Supprimer</button>
				<button action="citizen_editLegacyResponsibleAction" align="center">Modifier</button>
				<button action="citizen_showSecondPartLegacyResponsibleAction" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_showSecondPartLegacyResponsibleAction">
				<title>Consulter un responsable légal</title>
				<form>/citizen/step1/shownSecondPartLegacyResponsible</form>
				<button script="validateAndReturn()" align="left" width="142" arrow="left">Page précédente</button>
			</state>

      		<state name="citizen_returnFromShowSecondPartLegacyResponsibleAction">
				<title>Consulter un responsable légal</title>
				<form>/citizen/step1/shownFirstPartLegacyResponsible</form>
				<button script="confirmDelete()" align="left">Supprimer</button>
				<button action="citizen_editLegacyResponsibleAction" align="center">Modifier</button>
				<button action="citizen_showSecondPartLegacyResponsibleAction" align="right">Page suivante</button>
			</state>
			
			<state name="citizen_removeLegacyResponsibleAction">
				<title>Enfant enregistré</title>
				<form>/citizen/step1/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="citizen_editChildAction" align="center-right">Modifier</button>
			</state>
			
      		<state name="citizen_editLegacyResponsibleAction">
				<title>Modifier un responsable légal</title>
				<form>/citizen/step1/editedFirstPartLegacyResponsible</form>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Page suivante</button>
			</state>	
					
			<state name="citizen_editFirstPartLegacyResponsibleAction">
				<title>Modifier un responsable légal</title>
				<form>/citizen/step1/editedSecondPartLegacyResponsible</form>
				<button script="validateAndReturn(responsibleForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Page suivante</button>
			</state>			
			
			<state name="citizen_editSecondPartLegacyResponsibleAction">
				<title>Modifier un responsable légal</title>
				<form>/citizen/step1/editedThirdPartLegacyResponsible</form>
				<button script="validateAndReturn(responsibleForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Enregistrer</button>
			</state>

			<state name="citizen_returnFromEditSecondPartLegacyResponsibleAction">
				<title>Modifier un responsable légal</title>
				<form>/citizen/step1/editedFirstPartLegacyResponsible</form>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Page suivante</button>
			</state>

			<state name="citizen_editThirdPartLegacyResponsibleAction">
				<title>Consulter un responsable légal</title>
				<form>/citizen/step1/shownFirstPartLegacyResponsible</form>
				<button script="confirmDelete()" align="left">Supprimer</button>
				<button action="citizen_editLegacyResponsibleAction" align="center">Modifier</button>
				<button action="citizen_showSecondPartLegacyResponsibleAction" align="right">Page suivante</button>
			</state>
           
			<state name="citizen_returnFromEditThirdPartLegacyResponsibleAction">
				<title>Modifier un responsable légal</title>
				<form>/citizen/step1/editedSecondPartLegacyResponsible</form>
				<button script="validateAndReturn(responsibleForm)" align="left" width="142" arrow="left">Page précédente</button>
				<button script="legacyResponsibleFormCancel()" align="center">Annuler saisie</button>
				<button script="validateAndSubmit(responsibleForm)" align="right">Page suivante</button>
			</state>
									
			<select name="familyHome" property="children" >
				<title>Les enfants du foyer</title>
				<empty>Aucun enfant saisi</empty>
				<display name="firstName"/>
				<display name="lastName" initial="true"/>
				<action confirm="changed" parameter="index">citizen_showChildAction</action> 
				<button script="addChild()">Ajouter un enfant</button>
			</select>
		</stage>
		
		<!--********************** AJOUT JUSTIFICATIFS ***********************-->
		<stage caption="Justificatifs" >
			<title>Justificatifs</title>
			<info>/common/justification/information</info>
			<default>citizen_showExplainAction</default>
			
			<state name="citizen_showExplainAction">
				<title>Sélection</title>
				<form>/common/justification/default</form>
			</state>
			
			<state name="citizen_addDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/citizen/step2/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>
		    
		    <state name="citizen_exceptionDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/citizen/step2/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>
			
			<state name="citizen_showDocumentAction">
				<title>Justificatif fourni</title>
				<form>/citizen/step2/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="citizen_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>
			
			<state name="citizen_uploadDocumentAction">
				<title>Justificatif fourni</title>
				<form>/citizen/step2/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="citizen_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>

			<state name="citizen_modifyDocumentAction">
				<title>Modifier un justificatif</title>
				<form>/citizen/step2/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="citizen_removeDocumentAction">
				<title>Sélection</title>
				<form>/common/justification/default</form>
			</state>
			
			<state name="citizen_addPageToDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/citizen/step2/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="citizen_removePageFromDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/citizen/step2/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="citizen_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>

			<state name="citizen_showCurrentPageDocumentAction">
				<title>Justificatif fourni</title>
				<form>/citizen/step2/zoom</form>
				<button action="citizen_showDocumentAction" align="left" arrow="left">Retour</button>
				<button action="citizen_modifyDocumentAction" align="center">Modifier</button>
				<button script="removePageDocument()" align="right">Supprimer</button>
			</state>

			<select name="cardRequest" property="expectedDocument" >
				<title>Justificatif(s) à fournir</title>
				<empty>Aucun</empty>
				<display name="type"/>
				<action parameter="typeId">citizen_addDocumentAction</action> 
			</select>
			
			<select name="cardRequest" property="suppliedDocument" >
				<title>Justificatif(s) fourni(s)</title>
				<empty>Aucun</empty>
				<display name="type"/>
				<action parameter="typeId">citizen_showDocumentAction</action> 
			</select>
		</stage>
		
		<!--************************ DEFINITION COMPTE **********************-->
		<stage caption="Définition Compte" >
			<title>Identifiant pour accéder à votre espace Cartevaloise</title>
			<info>/citizen/step3/information</info>
			<default>citizen_prepareLoginAction</default>
			<previous>previousStageJustification()</previous>
			<next>validateAndSubmit()</next>
			
			<state name="citizen_prepareLoginAction">
				<title>Processus d'inscription</title>
				<form>/citizen/step3/default</form>
				<button script="validateAndSubmit()" align="right">Enregistrer</button>
			</state>
		</stage>
		
		<!-- ******************* VALIDATION *********************-->
		<stage caption="Validation" >
			<title>Validation et fin</title>
			<info>/citizen/step4/information</info>
			<default>citizen_prepareValidationAction</default>
			<previous>previousStageLogin()</previous>
			<next>false</next>
			
			<state name="citizen_prepareValidationAction">
				<title>Validation</title>
				<form>/citizen/step4/default</form>
			</state>

			<state name="citizen_validationAction">
				<title>Validation</title>
				<form>/citizen/step4/shown</form>
			</state>
		</stage>
	</process>
	
	<!--****************** PROCESSUS INSCRIPTION SCOLAIRE *******************-->
	<process name="eSchool">
		<title>Inscription scolaire</title>
		<data name="schoolChildRegistrationRequest" access="schoolChildRegistrationRequest" />

	    <!-- ******************* INSCRIPTION ENFANTS *********************-->
		<stage caption="Inscription" >
			<title>Inscription de l'enfant</title>
			<info>/school/step0/information</info>
			<confirm name="changed">Vos modifications éventuelles ou votre enregistrement sera perdu ! Voulez-vous continuer ?</confirm>
			<default>school_defaultSchoolRegistrationAction</default>
			<previous>begin()</previous>
			<next>registerChild()</next>
			
			<state name="school_defaultSchoolRegistrationAction">
				<title>Inscription scolaire</title>
				<form>/school/step0/default</form>
			</state>

			<state name="school_showUnregistredChildAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/school/step0/edited</form>
				<button script="schoolRegistrationCancel()" align="center-left">Annuler Saisie</button>
				<button script="validateAndSubmit()" align="center-right">Enregistrer</button>
			</state>
						
			<state name="school_registerChildAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/school/step0/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="school_editChildAction" align="center-right">Modifier</button>				
			</state>

			<state name="school_showRegistredChildAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/school/step0/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="school_editChildAction" align="center-right">Modifier</button>				
			</state>

			<state name="school_editChildAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/school/step0/edited</form>
				<button script="schoolRegistrationCancel()" align="center-left">Annuler Saisie</button>
				<button script="validateAndSubmit()" align="center-right">Enregistrer</button>
			</state>
												
			<select name="familyHome" property="unregistredSchoolChildrenNotCurrentlyRegistring" >
				<title>Enfant(s) non-inscrit(s)</title>
				<empty>Aucun</empty>
				<display name="firstName"/>
				<display name="lastName"  initial="true"/>
				<action confirm="changed" parameter="index">school_showUnregistredChildAction</action> 
			</select>
			
			<select name="familyHome" property="schoolChildrenToRegister" >
				<title>Enfant(s) à inscrire</title>
				<empty>Aucun</empty>
				<display name="firstName"/>
				<display name="lastName"  initial="true"/>
				<action parameter="index">school_showRegistredChildAction</action> 
			</select>		
		</stage>

	    <!-- ******************* AJOUT JUSTIFICATIFS *********************-->	
		<stage caption="Justificatifs" >
			<title>Justificatifs</title>
			<info>/common/justification/information</info>
			<default>school_showExplainAction</default>
			<previous>school_previousStepRegistrationAction.do</previous>
			<next>school_nextStepRegulationAction.do</next>
			
			<state name="school_showExplainAction">
				<title>Sélection</title>
				<form>/common/justification/default</form>
			</state>
			
			<state name="school_addDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/school/step1/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>
			
			<state name="school_showDocumentAction">
				<title>Justificatif fourni</title>
				<form>/school/step1/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="school_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>
			
			<state name="school_uploadDocumentAction">
				<title>Justificatif fourni</title>
				<form>/school/step1/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="school_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>

			<state name="school_exceptionDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/school/step1/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="school_modifyDocumentAction">
				<title>Modifier un justificatif</title>
				<form>/school/step1/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="school_removeDocumentAction">
				<title>Sélectionner un justificatif</title>
				<form>/common/justification/default</form>
			</state>
			
			<state name="school_addPageToDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/school/step1/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="school_removePageFromDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/school/step1/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="school_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>

			<state name="school_showCurrentPageDocumentAction">
				<title>Justificatif fourni</title>
				<form>/school/step1/zoom</form>
				<button action="school_showDocumentAction" align="left" arrow="left">Retour</button>
				<button action="school_modifyDocumentAction" align="center">Modifier</button>
				<button script="removePageDocument()" align="right">Supprimer</button>				
			</state>
			
			<select name="schoolChildRegistrationRequest" property="expectedDocument" >
				<title>Justificatif(s) à fournir</title>
				<empty>Aucun</empty>
				<display name="type"/>
				<action parameter="typeId">school_addDocumentAction</action> 
			</select>
			
			<select name="schoolChildRegistrationRequest" property="suppliedDocument" >
				<title>Justificatif(s) fourni(s)</title>
				<empty>Aucun</empty>
				<display name="type"/>
				<action parameter="typeId">school_showDocumentAction</action> 
			</select>
		</stage>
		
		<!-- ******************* REGLEMENTAIRE *********************-->
		<stage caption="Règlementaire" >
			<title>Règlementaire</title>
			<info>/school/step2/information</info>
			<default>school_showRegulationAction</default>
			<previous>previousStageJustification()</previous>
			<next>validateAndSubmit()</next>
			
			<state name="school_showRegulationAction">
				<title>Règlementaire</title>
				<form>/school/step2/edited</form>
				<button script="validateAndSubmit()" align="right">Enregistrer</button>
			</state>

			<state name="school_removeRegulationAction">
				<title>Règlementaire</title>
				<form>/school/step2/edited</form>
				<button script="validateAndSubmit()" align="right">Enregistrer</button>
			</state>
		</stage>	
		
		<!-- ******************* VALIDATION *********************-->	
		<stage caption="Validation" >
			<title>Validation et fin</title>
			<info>/school/step3/information</info>
			<default>school_prepareValidationAction</default>
			<previous>previousStageRegulation()</previous>
			<next>false</next>
			
			<state name="school_prepareValidationAction">
				<title>Validation</title>
				<form>/school/step3/default</form>
			</state>

			<state name="school_validationAction">
				<title>Validation</title>
				<form>/school/step3/shown</form>
			</state>
			
			<state name="school_printAction">
				<title>Validation</title>
				<form>/school/step3/shown</form>
			</state>
		</stage>
	</process>
	
	<!--******************** PROCESSUS INSCRIPTION PERI-SCOLAIRE ************************-->
	<process name="ePeriSchool">
		<title>Inscription péri-scolaire</title>
		<data name="periSchoolChildRegistrationRequest" access="periSchoolChildRegistrationRequest" />

		<!-- *******************INSCRIPTION ENFANT *********************-->
		<stage caption="Inscription" >
			<title>Inscription de l'enfant</title>
			<info>/perischool/step0/information</info>
			<confirm name="changed">Vos modifications éventuelles ou votre enregistrement sera perdu ! Voulez-vous continuer ?</confirm>
			<default>periSchool_defaultPeriSchoolRegistrationAction</default>
			<previous>begin()</previous>
			<next>registerChild()</next>
			
			<state name="periSchool_defaultPeriSchoolRegistrationAction">
				<title>Inscription péri-scolaire</title>
				<form>/perischool/step0/default</form>
			</state>

			<state name="periSchool_showUnregistredChildAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/perischool/step0/activityChoice</form>
				<button script="periSchoolRegistrationCancel()" align="center">Annuler Saisie</button>
				<button script="submitChoosenActivity()" align="right">Page suivante</button>
			</state>
			
		    <state name="periSchool_chooseActivityAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/perischool/step0/edited</form>
				<button script="validateAndReturn()" align="left" arrow="left" width="142">Page précédente</button>
				<button script="periSchoolRegistrationCancel()" align="center">Annuler Saisie</button>
				<button script="validateAndSubmit()" align="right">Enregistrer</button>
			</state>
			
			<state name="periSchool_prepareActivityAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/perischool/step0/activityChoice</form>
				<button script="periSchoolRegistrationCancel()" align="center">Annuler Saisie</button>
				<button script="submitChoosenActivity()" align="right">Page suivante</button>
			</state>			
			
			<state name="periSchool_registerChildAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/perischool/step0/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="periSchool_editChildAction" align="center-right">Modifier</button>				
			</state>

			<state name="periSchool_showRegistredChildAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/perischool/step0/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="periSchool_editChildAction" align="center-right">Modifier</button>				
			</state>

			<state name="periSchool_editChildAction" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/perischool/step0/activityChoice</form>
				<button script="periSchoolRegistrationCancel()" align="center">Annuler Saisie</button>
				<button script="submitChoosenActivity()" align="right">Page suivante</button>
			</state>
						
			<select name="familyHome" property="unregistredPeriSchoolChildrenNotCurrentlyRegistring" >
				<title>Enfant(s) non-inscrit(s)</title>
				<empty>Aucun</empty>
				<display name="firstName"/>
				<display name="lastName"  initial="true"/>
				<action confirm="changed" parameter="index">periSchool_showUnregistredChildAction</action> 
			</select>
			
			<select name="familyHome" property="periSchoolChildrenToRegister" >
				<title>Enfant(s) à inscrire</title>
				<empty>Aucun</empty>
				<display name="firstName"/>
				<display name="lastName"  initial="true"/>
				<action parameter="index">periSchool_showRegistredChildAction</action> 
			</select>
		</stage>
        
        <!-- **************INSCRIPTION PERSONNES A CONTACTER**************-->		
		<stage caption="Personnes à contacter" >
			<title>Personnes à contacter</title>
			<info>/perischool/step1/information</info>
			<default>periSchool_defaultContactPersonAction</default>
			<previous>previousStageRegistration()</previous>
			<next>nextStageAuthorizedPerson()</next>
				
			<state name="periSchool_defaultContactPersonAction">
				<title>Ajouter une personne</title>
				<form>/perischool/step1/default</form>
			</state>
			
			<state name="periSchool_showContactPersonAction">
				<title>Consulter une personne</title>
				<form>/perischool/step1/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="periSchool_editContactPersonAction" align="center-right">Modifier</button>
			</state>
			
			<state name="periSchool_saveContactPersonAction">
				<title>Personne enregistrée</title>
				<form>/perischool/step1/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="periSchool_editContactPersonAction" align="center-right">Modifier</button>
			</state>			
			
			<state name="periSchool_removeContactPersonAction">
				<title>Ajouter une personne</title>
				<form>/perischool/step1/default</form>
			</state>
			
			<state name="periSchool_addContactPersonAction">
				<title>Ajouter une personne</title>
				<form>/perischool/step1/edited</form>
				<button script="periSchoolContactPersonCancel()" align="center-left">Annuler Saisie</button>				
				<button script="validateAndSubmitContactPerson()" align="center-right">Enregistrer</button>
			</state>
											
			<state name="periSchool_editContactPersonAction">
				<title>Modifier une personne</title>
				<form>/perischool/step1/edited</form>
				<button script="periSchoolContactPersonCancel()" align="center-left">Annuler Saisie</button>				
				<button script="validateAndSubmitContactPerson()" align="center-right">Enregistrer</button>
			</state>
						
			<select name="periSchoolChildRegistrationRequest" property="personToContactList" >
				<title>Personnes à contacter</title>
				<empty>Aucune personne saisie</empty>
				<display name="firstName"/>
				<display name="lastName"  initial="true"/>
				<action parameter="index">periSchool_showContactPersonAction</action> 
				<button action="periSchool_addContactPersonAction">Ajouter une personne</button>
			</select>
		</stage>
		
		<!-- ************* INSCRIPTION PERSONNES AUTORISEES ************-->
		<stage caption="Personnes autorisées" >
			<title>Personnes autorisées</title>
			<info>/perischool/step2/information</info>
			<default>periSchool_defaultAuthorizedPersonAction</default>
			<previous>previousStageContactPersonChoice()</previous>
			<next>nextStageJustification()</next>
				
			<state name="periSchool_defaultAuthorizedPersonAction">
				<title>Ajouter une personne</title>
				<form>/perischool/step2/default</form>
			</state>
			
			<state name="periSchool_showAuthorizedPersonAction">
				<title>Consulter une personne</title>
				<form>/perischool/step2/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="periSchool_editAuthorizedPersonAction" align="center-right">Modifier</button>
			</state>
			
			<state name="periSchool_saveAuthorizedPersonAction">
				<title>Personne enregistrée</title>
				<form>/perischool/step2/shown</form>
				<button script="confirmDelete()" align="center-left">Supprimer</button>
				<button action="periSchool_editAuthorizedPersonAction" align="center-right">Modifier</button>
			</state>			
						
			<state name="periSchool_removeAuthorizedPersonAction">
				<title>Ajouter une personne</title>
				<form>/perischool/step2/default</form>
			</state>
			
			<state name="periSchool_addAuthorizedPersonAction">
				<title>Ajouter une personne</title>
				<form>/perischool/step2/edited</form>
				<button script="periSchoolAuthorizedPersonCancel()" align="center-left">Annuler Saisie</button>
				<button script="validateAndSubmitAuthorizedPerson()" align="center-right">Enregistrer</button>
			</state>		
									
			<state name="periSchool_editAuthorizedPersonAction">
				<title>Modifier une personne</title>
				<form>/perischool/step2/edited</form>
				<button script="periSchoolAuthorizedPersonCancel()" align="center-left">Annuler Saisie</button>
				<button script="validateAndSubmitAuthorizedPerson()" align="center-right">Enregistrer</button>
			</state>
						
			<select name="periSchoolChildRegistrationRequest" property="authorizedPersonChildPickUpList" >
				<title>Personnes autorisées</title>
				<empty>Aucune personne saisie</empty>
				<display name="firstName"/>
				<display name="lastName" initial="true"/>
				<action parameter="index">periSchool_showAuthorizedPersonAction</action> 
				<button action="periSchool_addAuthorizedPersonAction">Ajouter une personne</button>
			</select>
		</stage>
		
		<!-- ******************* AJOUT JUSTIFICATIFS *********************-->
		<stage caption="Justificatifs" >
			<title>Justificatifs</title>
			<info>/common/justification/information</info>
			<default>periSchool_showExplainAction</default>
			<previous>periSchool_previousStepAuthorizedPersonChoiceAction.do</previous>
			<next>periSchool_nextStepRegulationAction.do</next>
			
			<state name="periSchool_showExplainAction">
				<title>Sélectionner un justificatif</title>
				<form>/common/justification/default</form>
			</state>
			
			<state name="periSchool_addDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/perischool/step3/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>
			
			<state name="periSchool_showDocumentAction">
				<title>Justificatif fourni</title>
				<form>/perischool/step3/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="periSchool_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>
			
			<state name="periSchool_uploadDocumentAction">
				<title>Justificatif fourni</title>
				<form>/perischool/step3/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="periSchool_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>

			<state name="periSchool_modifyDocumentAction">
				<title>Modifier un justificatif</title>
				<form>/perischool/step3/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="periSchool_exceptionDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/perischool/step3/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="periSchool_removeDocumentAction">
				<title>Sélectionner un justificatif</title>
				<form>/common/justification/default</form>
			</state>
			
			<state name="periSchool_addPageToDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/perischool/step3/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="periSchool_removePageFromDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/perischool/step3/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="periSchool_addPageToDocumentAction" align="center-right">Ajouter page</button>			
			</state>

			<state name="periSchool_showCurrentPageDocumentAction">
				<title>Justificatif fourni</title>
				<form>/perischool/step3/zoom</form>
				<button action="periSchool_showDocumentAction" align="left" arrow="left">Retour</button>
				<button action="periSchool_modifyDocumentAction" align="center">Modifier</button>
				<button script="removePageDocument()" align="right">Supprimer</button>
			</state>
			
			<select name="periSchoolChildRegistrationRequest" property="expectedDocument" >
				<title>Justificatif(s) à fournir</title>
				<empty>Aucun</empty>
				<display name="type"/>
				<action parameter="typeId">periSchool_addDocumentAction</action> 
			</select>
			
			<select name="periSchoolChildRegistrationRequest" property="suppliedDocument" >
				<title>Justificatif(s) fourni(s)</title>
				<empty>Aucun</empty>
				<display name="type"/>
				<action parameter="typeId">periSchool_showDocumentAction</action> 
			</select>
		</stage>
		
		<!-- ******************* REGLEMENTAIRE ******************-->
		<stage caption="Règlementaire" >
			<title>Règlementaire</title>
			<info>/perischool/step4/information</info>
			<default>periSchool_showRegulationAction</default>
			<previous>previousStageJustification()</previous>
			<next>validateAndSubmit()</next>
			
			<state name="periSchool_showRegulationAction">
				<title>Règlementaire</title>
				<form>/perischool/step4/edited</form>
				<button script="validateAndSubmit()" align="right">Enregistrer</button>
			</state>

			<state name="periSchool_removeRegulationAction">
				<title>Règlementaire</title>
				<form>/perischool/step4/edited</form>
				<button script="validateAndSubmit()" align="right">Enregistrer</button>
			</state>
		</stage>		

        <!-- ******************* VALIDATION *******************--> 
		<stage caption="Validation" >
			<title>Validation et fin</title>
			<info>/perischool/step5/information</info>
			<default>periSchool_prepareValidationAction</default>
			<previous>previousStageRegulation()</previous>
			<next>false</next>
			
			<state name="periSchool_prepareValidationAction">
				<title>Validation</title>
				<form>/perischool/step5/default</form>
			</state>

			<state name="periSchool_validationAction">
				<title>Validation</title>
				<form>/perischool/step5/shown</form>
			</state>
			
		    <state name="periSchool_printAction">
				<title>Validation</title>
				<form>/perischool/step5/shown</form>
			</state>
		</stage>						
	</process>
	
	<!--******************** PROCESSUS INSCRIPTION RESTAURANT SCOLAIRE **********************-->
	<process name="eSchoolCanteen">
		<title>Inscription restaurant scolaire</title>
		<script src="./js/validation.js"/>
		<script src="./js/messages.js"/>
		<script src="./js/schoolcanteen/inscription.js" />
		<data name="schoolCanteenChildRegistrationRequest" access="schoolCanteenChildRegistrationRequest" />
		<package>fr.cg95.cvq.fo.schoolcanteen</package>

  	    <!-- ******************* INSCRIPTION *********************-->
		<stage name="Inscription" caption="Inscription">
			<title>Inscription</title>
			<info>/schoolcanteen/step0/information</info>

			<confirm name="continue" check="childSelected">Vous devez sélectionner un enfant</confirm>
			<confirm name="cancel">Attention ! Les données de l'inscription au restaurant scolaire n'ont pas été enregistrées ! Voulez-vous quand même annuler la saisie ?</confirm>
			<confirm name="delete">Voulez-vous vraiment supprimer l'inscription au restaurant scolaire de l'enfant sélectionné ?</confirm>
			<confirm name="childChanged">Vos modifications éventuelles ou votre enregistrement sera perdu ! Voulez-vous continuer ?</confirm>

			<default>default</default>
			<previous>begin()</previous>
			<next confirm="continue">schoolCanteen_nextStepJustificationAction.do</next>
			
			<state name="default">
				<title>Inscription restaurant scolaire</title>
				<form>/schoolcanteen/inscription/default</form>
			</state>

			<state name="canteen" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/schoolcanteen/inscription/canteen</form>
				<button confirm="cancel" transition="default" align="center">Annuler Saisie</button>
				<button script="processSubmit" action="" transition="permission" align="right">Page suivante</button>
			</state>			

			<state name="permission" change="confirm">
				<title>Enfant à inscrire</title>
				<form>/schoolcanteen/inscription/permission</form>				
				<button script="processSubmit" action="" transition="canteen" align="left" arrow="left" width="142">Page précédente</button>
				<button confirm="cancel" transition="default" align="center">Annuler Saisie</button>
				<button script="processSubmit" action="save" transition="display" align="right" >Enregistrer</button>
			</state>			
		   		
			<state name="display">
				<title>Enfant à inscrire</title>
				<form>/schoolcanteen/inscription/display</form>
				<button confirm="delete" action="schoolCanteen_removeSchoolCanteenRegistrationAction.do" transition="default" align="center-left">Supprimer</button>
				<button action="schoolCanteen_editChildAction" transition="canteen" align="center-right">Modifier</button>
			</state>			

			<select name="familyHome" property="unregistredSchoolCanteenChildrenNotCurrentlyRegistring" >
				<title>Enfant(s) non-inscrit(s)</title>
				<empty>Aucun</empty>
				<display name="firstName"/>
				<display name="lastName"  initial="true"/>
				<action confirm="childChanged" parameter="index" transition="canteen">schoolCanteen_showUnregistredChildAction</action> 
			</select>
			
			<select name="familyHome" property="schoolCanteenChildrenToRegister" >
				<title>Enfant(s) à inscrire</title>
				<empty>Aucun</empty>
				<display name="firstName"/>
				<display name="lastName"  initial="true"/>
				<action parameter="index" transition="display">schoolCanteen_showRegistredChildAction</action> 
			</select>
		</stage>

	    <!-- ******************* AJOUT JUSTIFICATIFS *********************-->		
		<stage name="Documents" caption="Justificatifs" >
			<title>Justificatifs</title>
			<info>/common/justification/information</info>
			<default>schoolCanteen_showExplainAction</default>
			<previous>schoolCanteen_previousStepRegistrationAction.do</previous>
			<next>schoolCanteen_nextStepRegulationAction.do</next>
			
			<state name="schoolCanteen_showExplainAction">
				<title>Sélectionner un justificatif</title>
				<form>/common/justification/default</form>
			</state>
			
			<state name="schoolCanteen_addDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/schoolcanteen/step1/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>
			
			<state name="schoolCanteen_showDocumentAction">
				<title>Justificatif fourni</title>
				<form>/schoolcanteen/step1/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="schoolCanteen_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>
			
			<state name="schoolCanteen_uploadDocumentAction">
				<title>Justificatif fourni</title>
				<form>/schoolcanteen/step1/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="schoolCanteen_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>
			
			<state name="schoolCanteen_exceptionDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/schoolcanteen/step1/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="schoolCanteen_modifyDocumentAction">
				<title>Modifier un justificatif</title>
				<form>/schoolcanteen/step1/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="schoolCanteen_removeDocumentAction">
				<title>Sélectionner un justificatif</title>
				<form>/common/justification/default</form>
			</state>
			
			<state name="schoolCanteen_addPageToDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/schoolcanteen/step1/edited</form>
				<button script="validateAndSubmit(documentForm)" align="center" cookie="TERMINAL" present="false">Envoyer</button>
			</state>

			<state name="schoolCanteen_removePageFromDocumentAction">
				<title>Ajouter un justificatif</title>
				<form>/schoolcanteen/step1/shown</form>
				<button script="removeDocument()" align="center-left">Supprimer</button>
				<button action="schoolCanteen_addPageToDocumentAction" align="center-right">Ajouter page</button>
			</state>

			<state name="schoolCanteen_showCurrentPageDocumentAction">
				<title>Justificatif fourni</title>
				<form>/schoolcanteen/step1/zoom</form>
				<button action="schoolCanteen_showDocumentAction" align="left" arrow="left">Retour</button>
				<button action="schoolCanteen_modifyDocumentAction" align="center">Modifier</button>
				<button script="removePageDocument()" align="right">Supprimer</button>				
			</state>

			<select name="schoolCanteenChildRegistrationRequest" property="expectedDocument" >
				<title>Justificatif(s) à fournir</title>
				<empty>Aucun</empty>
				<display name="type"/>
				<action parameter="typeId">schoolCanteen_addDocumentAction</action> 
			</select>
			
			<select name="schoolCanteenChildRegistrationRequest" property="suppliedDocument" >
				<title>Justificatif(s) fourni(s)</title>
				<empty>Aucun</empty>
				<display name="type"/>
				<action parameter="typeId">schoolCanteen_showDocumentAction</action> 
			</select>
		</stage>
		
		<!-- ******************* REGLEMENTAIRE *********************-->
		<stage name="Rules" caption="Règlementaire" >
			<title>Règlementaire</title>
			<info>/schoolcanteen/step2/information</info>
			<default>schoolCanteen_showRegulationAction</default>
			<previous>previousStageJustification()</previous>			
			<next>validateAndSubmit()</next>
			
			<state name="schoolCanteen_showRegulationAction">
				<title>Règlementaire</title>
				<form>/schoolcanteen/step2/edited</form>
				<button script="validateAndSubmit()" align="right">Enregistrer</button>
			</state>

			<state name="schoolCanteen_removeRegulationAction">
				<title>Règlementaire</title>
				<form>/schoolcanteen/step2/edited</form>
				<button script="validateAndSubmit()" align="right">Enregistrer</button>
			</state>
		</stage>	
		
		<!-- ******************* VALIDATION *********************-->
		<stage name="Validation" caption="Validation" >
			<title>Validation et fin</title>
			<info>/schoolcanteen/step3/information</info>
			<default>schoolCanteen_prepareValidationAction</default>
			<previous>previousStageRegulation()</previous>
			<next>false</next>
			
			<state name="schoolCanteen_prepareValidationAction">
				<title>Validation</title>
				<form>/schoolcanteen/step3/default</form>
			</state>

			<state name="schoolCanteen_validationAction">
				<title>Validation</title>
				<form>/schoolcanteen/step3/shown</form>
			</state>
			
			<state name="schoolCanteen_printAction">
				<title>Validation</title>
				<form>/schoolcanteen/step3/shown</form>
			</state>
		</stage>
	</process>
  </processes>		
	<!--  FIN PROCESSUS -->			
</cvq>

