<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN" "http://www.springframework.org/dtd/spring-beans.dtd">

<beans>

  <bean id="configurer"
    class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location">
      <value>/WEB-INF/deploy.properties</value>
    </property>
  </bean>

  <!-- ResourceViewResolver -->
  <bean id="viewResolver"
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="cache" value="true" />
    <property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
    <property name="prefix" value="/WEB-INF/view/bo/tasks/" />
    <property name="suffix" value=".jsp" />
  </bean>

  <!-- PortletMode controller Map -->
  <bean id="portletModeHandlerMapping"
    class="org.springframework.web.portlet.handler.PortletModeHandlerMapping">
    <property name="portletModeMap">
      <map>
        <entry key="view" value-ref="viewController" />
        <entry key="config" value-ref="configController" />
      </map>
    </property>
  </bean>

  <bean id="viewController" class="com.zenexity.pict.cvq.bo.tasks.ViewController">
    <property name="agentTaskService" ref="httpAgentInvokerProxy" />
    <property name="cvqHttpInvoker" ref="cvqHttpInvoker" />
  </bean>

  <bean id="configController" class="com.zenexity.pict.cvq.bo.tasks.ConfigController" />

  <bean id="cvqHttpInvoker" class="com.zenexity.pict.cvq.bo.tasks.CvqHttpInvoker">
    <property name="serviceUrl">
      <value>${service_url}</value>
    </property>
  </bean>

  <bean id="httpAgentInvokerProxy"
    class="org.springframework.remoting.httpinvoker.HttpInvokerProxyFactoryBean">
    <property name="serviceUrl">
      <value>${service_url}${bo_context_path}/AgentTaskService</value>
    </property>
    <property name="serviceInterface">
      <value>fr.cg95.cvq.exporter.service.bo.IAgentTaskService</value>
    </property>
    <property name="httpInvokerRequestExecutor" ref="cvqHttpInvoker" />
  </bean>

</beans>