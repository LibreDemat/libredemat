(function(){var c=YAHOO.util.Dom,a=YAHOO.util.Event,d=YAHOO.lang;if(YAHOO.widget.Button){YAHOO.widget.ToolbarButtonAdvanced=YAHOO.widget.Button;YAHOO.widget.ToolbarButtonAdvanced.prototype.buttonType="rich";YAHOO.widget.ToolbarButtonAdvanced.prototype.checkValue=function(g){var f=this.getMenu().getItems();if(f.length===0){this.getMenu()._onBeforeShow();f=this.getMenu().getItems()}for(var e=0;e<f.length;e++){f[e].cfg.setProperty("checked",false);if(f[e].value==g){f[e].cfg.setProperty("checked",true)}}}}else{YAHOO.widget.ToolbarButtonAdvanced=function(){}}YAHOO.widget.ToolbarButton=function(f,e){if(d.isObject(arguments[0])&&!c.get(f).nodeType){e=f}var h=(e||{});var g={element:null,attributes:h};if(!g.attributes.type){g.attributes.type="push"}g.element=document.createElement("span");g.element.setAttribute("unselectable","on");g.element.className="yui-button yui-"+g.attributes.type+"-button";g.element.innerHTML='<span class="first-child"><a href="#">LABEL</a></span>';g.element.firstChild.firstChild.tabIndex="-1";g.attributes.id=(g.attributes.id||c.generateId());g.element.id=g.attributes.id;YAHOO.widget.ToolbarButton.superclass.constructor.call(this,g.element,g.attributes)};YAHOO.extend(YAHOO.widget.ToolbarButton,YAHOO.util.Element,{buttonType:"normal",_handleMouseOver:function(){if(!this.get("disabled")){this.addClass("yui-button-hover");this.addClass("yui-"+this.get("type")+"-button-hover")}},_handleMouseOut:function(){this.removeClass("yui-button-hover");this.removeClass("yui-"+this.get("type")+"-button-hover")},checkValue:function(g){if(this.get("type")=="menu"){var f=this._button.options;for(var e=0;e<f.length;e++){if(f[e].value==g){f.selectedIndex=e}}}},init:function(f,e){YAHOO.widget.ToolbarButton.superclass.init.call(this,f,e);this.on("mouseover",this._handleMouseOver,this,true);this.on("mouseout",this._handleMouseOut,this,true);this.on("click",function(g){a.stopEvent(g);return false},this,true)},initAttributes:function(e){YAHOO.widget.ToolbarButton.superclass.initAttributes.call(this,e);this.setAttributeConfig("value",{value:e.value});this.setAttributeConfig("menu",{value:e.menu||false});this.setAttributeConfig("type",{value:e.type,writeOnce:true,method:function(j){var h,g;if(!this._button){this._button=this.get("element").getElementsByTagName("a")[0]}switch(j){case"select":case"menu":h=document.createElement("select");h.id=this.get("id");var k=this.get("menu");for(var f=0;f<k.length;f++){g=document.createElement("option");g.innerHTML=k[f].text;g.value=k[f].value;if(k[f].checked){g.selected=true}h.appendChild(g)}this._button.parentNode.replaceChild(h,this._button);a.on(h,"change",this._handleSelect,this,true);this._button=h;break}}});this.setAttributeConfig("disabled",{value:e.disabled||false,method:function(f){if(f){this.addClass("yui-button-disabled");this.addClass("yui-"+this.get("type")+"-button-disabled")}else{this.removeClass("yui-button-disabled");this.removeClass("yui-"+this.get("type")+"-button-disabled")}if((this.get("type")=="menu")||(this.get("type")=="select")){this._button.disabled=f}}});this.setAttributeConfig("label",{value:e.label,method:function(f){if(!this._button){this._button=this.get("element").getElementsByTagName("a")[0]}if(this.get("type")=="push"){this._button.innerHTML=f}}});this.setAttributeConfig("title",{value:e.title});this.setAttributeConfig("container",{value:null,writeOnce:true,method:function(f){this.appendTo(f)}})},_handleSelect:function(f){var e=a.getTarget(f);var g=e.options[e.selectedIndex].value;this.fireEvent("change",{type:"change",value:g})},getMenu:function(){return this.get("menu")},destroy:function(){a.purgeElement(this.get("element"),true);this.get("element").parentNode.removeChild(this.get("element"));for(var e in this){if(d.hasOwnProperty(this,e)){this[e]=null}}},fireEvent:function(f,e){if(this.DOM_EVENTS[f]&&this.get("disabled")){a.stopEvent(e);return}YAHOO.widget.ToolbarButton.superclass.fireEvent.call(this,f,e)},toString:function(){return"ToolbarButton ("+this.get("id")+")"}})})();(function(){var d=YAHOO.util.Dom,a=YAHOO.util.Event,e=YAHOO.lang;var c=function(g){var f=g;if(e.isString(g)){f=this.getButtonById(g)}if(e.isNumber(g)){f=this.getButtonByIndex(g)}if((!(f instanceof YAHOO.widget.ToolbarButton))&&(!(f instanceof YAHOO.widget.ToolbarButtonAdvanced))){f=this.getButtonByValue(g)}if((f instanceof YAHOO.widget.ToolbarButton)||(f instanceof YAHOO.widget.ToolbarButtonAdvanced)){return f}return false};YAHOO.widget.Toolbar=function(j,i){if(e.isObject(arguments[0])&&!d.get(j).nodeType){i=j}var l={};if(i){e.augmentObject(l,i)}var k={element:null,attributes:l};if(e.isString(j)&&d.get(j)){k.element=d.get(j)}else{if(e.isObject(j)&&d.get(j)&&d.get(j).nodeType){k.element=d.get(j)}}if(!k.element){k.element=document.createElement("DIV");k.element.id=d.generateId();if(l.container&&d.get(l.container)){d.get(l.container).appendChild(k.element)}}if(!k.element.id){k.element.id=((e.isString(j))?j:d.generateId())}var g=document.createElement("fieldset");var h=document.createElement("legend");h.innerHTML="Toolbar";g.appendChild(h);var f=document.createElement("DIV");k.attributes.cont=f;d.addClass(f,"yui-toolbar-subcont");g.appendChild(f);k.element.appendChild(g);k.element.tabIndex=-1;k.attributes.element=k.element;k.attributes.id=k.element.id;this._configuredButtons=[];YAHOO.widget.Toolbar.superclass.constructor.call(this,k.element,k.attributes)};YAHOO.extend(YAHOO.widget.Toolbar,YAHOO.util.Element,{_configuredButtons:null,_addMenuClasses:function(j,f,k){d.addClass(this.element,"yui-toolbar-"+k.get("value")+"-menu");if(d.hasClass(k._button.parentNode.parentNode,"yui-toolbar-select")){d.addClass(this.element,"yui-toolbar-select-menu")}var g=this.getItems();for(var h=0;h<g.length;h++){d.addClass(g[h].element,"yui-toolbar-"+k.get("value")+"-"+((g[h].value)?g[h].value.replace(/ /g,"-").toLowerCase():g[h]._oText.nodeValue.replace(/ /g,"-").toLowerCase()));d.addClass(g[h].element,"yui-toolbar-"+k.get("value")+"-"+((g[h].value)?g[h].value.replace(/ /g,"-"):g[h]._oText.nodeValue.replace(/ /g,"-")))}},buttonType:YAHOO.widget.ToolbarButton,dd:null,_colorData:{"#111111":"Obsidian","#2D2D2D":"Dark Gray","#434343":"Shale","#5B5B5B":"Flint","#737373":"Gray","#8B8B8B":"Concrete","#A2A2A2":"Gray","#B9B9B9":"Titanium","#000000":"Black","#D0D0D0":"Light Gray","#E6E6E6":"Silver","#FFFFFF":"White","#BFBF00":"Pumpkin","#FFFF00":"Yellow","#FFFF40":"Banana","#FFFF80":"Pale Yellow","#FFFFBF":"Butter","#525330":"Raw Siena","#898A49":"Mildew","#AEA945":"Olive","#7F7F00":"Paprika","#C3BE71":"Earth","#E0DCAA":"Khaki","#FCFAE1":"Cream","#60BF00":"Cactus","#80FF00":"Chartreuse","#A0FF40":"Green","#C0FF80":"Pale Lime","#DFFFBF":"Light Mint","#3B5738":"Green","#668F5A":"Lime Gray","#7F9757":"Yellow","#407F00":"Clover","#8A9B55":"Pistachio","#B7C296":"Light Jade","#E6EBD5":"Breakwater","#00BF00":"Spring Frost","#00FF80":"Pastel Green","#40FFA0":"Light Emerald","#80FFC0":"Sea Foam","#BFFFDF":"Sea Mist","#033D21":"Dark Forrest","#438059":"Moss","#7FA37C":"Medium Green","#007F40":"Pine","#8DAE94":"Yellow Gray Green","#ACC6B5":"Aqua Lung","#DDEBE2":"Sea Vapor","#00BFBF":"Fog","#00FFFF":"Cyan","#40FFFF":"Turquoise Blue","#80FFFF":"Light Aqua","#BFFFFF":"Pale Cyan","#033D3D":"Dark Teal","#347D7E":"Gray Turquoise","#609A9F":"Green Blue","#007F7F":"Seaweed","#96BDC4":"Green Gray","#B5D1D7":"Soapstone","#E2F1F4":"Light Turquoise","#0060BF":"Summer Sky","#0080FF":"Sky Blue","#40A0FF":"Electric Blue","#80C0FF":"Light Azure","#BFDFFF":"Ice Blue","#1B2C48":"Navy","#385376":"Biscay","#57708F":"Dusty Blue","#00407F":"Sea Blue","#7792AC":"Sky Blue Gray","#A8BED1":"Morning Sky","#DEEBF6":"Vapor","#0000BF":"Deep Blue","#0000FF":"Blue","#4040FF":"Cerulean Blue","#8080FF":"Evening Blue","#BFBFFF":"Light Blue","#212143":"Deep Indigo","#373E68":"Sea Blue","#444F75":"Night Blue","#00007F":"Indigo Blue","#585E82":"Dockside","#8687A4":"Blue Gray","#D2D1E1":"Light Blue Gray","#6000BF":"Neon Violet","#8000FF":"Blue Violet","#A040FF":"Violet Purple","#C080FF":"Violet Dusk","#DFBFFF":"Pale Lavender","#302449":"Cool Shale","#54466F":"Dark Indigo","#655A7F":"Dark Violet","#40007F":"Violet","#726284":"Smoky Violet","#9E8FA9":"Slate Gray","#DCD1DF":"Violet White","#BF00BF":"Royal Violet","#FF00FF":"Fuchsia","#FF40FF":"Magenta","#FF80FF":"Orchid","#FFBFFF":"Pale Magenta","#4A234A":"Dark Purple","#794A72":"Medium Purple","#936386":"Cool Granite","#7F007F":"Purple","#9D7292":"Purple Moon","#C0A0B6":"Pale Purple","#ECDAE5":"Pink Cloud","#BF005F":"Hot Pink","#FF007F":"Deep Pink","#FF409F":"Grape","#FF80BF":"Electric Pink","#FFBFDF":"Pink","#451528":"Purple Red","#823857":"Purple Dino","#A94A76":"Purple Gray","#7F003F":"Rose","#BC6F95":"Antique Mauve","#D8A5BB":"Cool Marble","#F7DDE9":"Pink Granite","#C00000":"Apple","#FF0000":"Fire Truck","#FF4040":"Pale Red","#FF8080":"Salmon","#FFC0C0":"Warm Pink","#441415":"Sepia","#82393C":"Rust","#AA4D4E":"Brick","#800000":"Brick Red","#BC6E6E":"Mauve","#D8A3A4":"Shrimp Pink","#F8DDDD":"Shell Pink","#BF5F00":"Dark Orange","#FF7F00":"Orange","#FF9F40":"Grapefruit","#FFBF80":"Canteloupe","#FFDFBF":"Wax","#482C1B":"Dark Brick","#855A40":"Dirt","#B27C51":"Tan","#7F3F00":"Nutmeg","#C49B71":"Mustard","#E1C4A8":"Pale Tan","#FDEEE0":"Marble"},_colorPicker:null,STR_COLLAPSE:"Collapse Toolbar",STR_EXPAND:"Expand Toolbar",STR_SPIN_LABEL:"Spin Button with value {VALUE}. Use Control Shift Up Arrow and Control Shift Down arrow keys to increase or decrease the value.",STR_SPIN_UP:"Click to increase the value of this input",STR_SPIN_DOWN:"Click to decrease the value of this input",_titlebar:null,browser:YAHOO.env.ua,_buttonList:null,_buttonGroupList:null,_sep:null,_sepCount:null,_dragHandle:null,_toolbarConfigs:{renderer:true},CLASS_CONTAINER:"yui-toolbar-container",CLASS_DRAGHANDLE:"yui-toolbar-draghandle",CLASS_SEPARATOR:"yui-toolbar-separator",CLASS_DISABLED:"yui-toolbar-disabled",CLASS_PREFIX:"yui-toolbar",init:function(g,f){YAHOO.widget.Toolbar.superclass.init.call(this,g,f)},initAttributes:function(f){YAHOO.widget.Toolbar.superclass.initAttributes.call(this,f);this.addClass(this.CLASS_CONTAINER);this.setAttributeConfig("buttonType",{value:f.buttonType||"basic",writeOnce:true,validator:function(g){switch(g){case"advanced":case"basic":return true}return false},method:function(g){if(g=="advanced"){if(YAHOO.widget.Button){this.buttonType=YAHOO.widget.ToolbarButtonAdvanced}else{this.buttonType=YAHOO.widget.ToolbarButton}}else{this.buttonType=YAHOO.widget.ToolbarButton}}});this.setAttributeConfig("buttons",{value:[],writeOnce:true,method:function(m){var k,j,l,h,g;for(k in m){if(e.hasOwnProperty(m,k)){if(m[k].type=="separator"){this.addSeparator()}else{if(m[k].group!==undefined){l=this.addButtonGroup(m[k]);if(l){h=l.length;for(g=0;g<h;g++){if(l[g]){this._configuredButtons[this._configuredButtons.length]=l[g].id}}}}else{j=this.addButton(m[k]);if(j){this._configuredButtons[this._configuredButtons.length]=j.id}}}}}}});this.setAttributeConfig("disabled",{value:false,method:function(g){if(this.get("disabled")===g){return false}if(g){this.addClass(this.CLASS_DISABLED);this.set("draggable",false);this.disableAllButtons()}else{this.removeClass(this.CLASS_DISABLED);if(this._configs.draggable._initialConfig.value){this.set("draggable",true)}this.resetAllButtons()}}});this.setAttributeConfig("cont",{value:f.cont,readOnly:true});this.setAttributeConfig("grouplabels",{value:((f.grouplabels===false)?false:true),method:function(g){if(g){d.removeClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"))}else{d.addClass(this.get("cont"),(this.CLASS_PREFIX+"-nogrouplabels"))}}});this.setAttributeConfig("titlebar",{value:false,method:function(h){if(h){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar)}this._titlebar=document.createElement("DIV");this._titlebar.tabIndex="-1";a.on(this._titlebar,"focus",function(){this._handleFocus()},this,true);d.addClass(this._titlebar,this.CLASS_PREFIX+"-titlebar");if(e.isString(h)){var g=document.createElement("h2");g.tabIndex="-1";g.innerHTML='<a href="#" tabIndex="0">'+h+"</a>";this._titlebar.appendChild(g);a.on(g.firstChild,"click",function(i){a.stopEvent(i)});a.on([g,g.firstChild],"focus",function(){this._handleFocus()},this,true)}if(this.get("firstChild")){this.insertBefore(this._titlebar,this.get("firstChild"))}else{this.appendChild(this._titlebar)}if(this.get("collapse")){this.set("collapse",true)}}else{if(this._titlebar){if(this._titlebar&&this._titlebar.parentNode){this._titlebar.parentNode.removeChild(this._titlebar)}}}}});this.setAttributeConfig("collapse",{value:false,method:function(i){if(this._titlebar){var h=null;var g=d.getElementsByClassName("collapse","span",this._titlebar);if(i){if(g.length>0){return true}h=document.createElement("SPAN");h.innerHTML="X";h.title=this.STR_COLLAPSE;d.addClass(h,"collapse");this._titlebar.appendChild(h);a.addListener(h,"click",function(){if(d.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){this.collapse(false)}else{this.collapse()}},this,true)}else{h=d.getElementsByClassName("collapse","span",this._titlebar);if(h[0]){if(d.hasClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed")){this.collapse(false)}h[0].parentNode.removeChild(h[0])}}}}});this.setAttributeConfig("draggable",{value:(f.draggable||false),method:function(g){if(g&&!this.get("titlebar")){if(!this._dragHandle){this._dragHandle=document.createElement("SPAN");this._dragHandle.innerHTML="|";this._dragHandle.setAttribute("title","Click to drag the toolbar");this._dragHandle.id=this.get("id")+"_draghandle";d.addClass(this._dragHandle,this.CLASS_DRAGHANDLE);if(this.get("cont").hasChildNodes()){this.get("cont").insertBefore(this._dragHandle,this.get("cont").firstChild)}else{this.get("cont").appendChild(this._dragHandle)}this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._dragHandle.id)}}else{if(this._dragHandle){this._dragHandle.parentNode.removeChild(this._dragHandle);this._dragHandle=null;this.dd=null}}if(this._titlebar){if(g){this.dd=new YAHOO.util.DD(this.get("id"));this.dd.setHandleElId(this._titlebar);d.addClass(this._titlebar,"draggable")}else{d.removeClass(this._titlebar,"draggable");if(this.dd){this.dd.unreg();this.dd=null}}}},validator:function(h){var g=true;if(!YAHOO.util.DD){g=false}return g}})},addButtonGroup:function(l){if(!this.get("element")){this._queue[this._queue.length]=["addButtonGroup",arguments];return false}if(!this.hasClass(this.CLASS_PREFIX+"-grouped")){this.addClass(this.CLASS_PREFIX+"-grouped")}var n=document.createElement("DIV");d.addClass(n,this.CLASS_PREFIX+"-group");d.addClass(n,this.CLASS_PREFIX+"-group-"+l.group);if(l.label){var g=document.createElement("h3");g.innerHTML=l.label;n.appendChild(g)}if(!this.get("grouplabels")){d.addClass(this.get("cont"),this.CLASS_PREFIX,"-nogrouplabels")}this.get("cont").appendChild(n);var k=document.createElement("ul");n.appendChild(k);if(!this._buttonGroupList){this._buttonGroupList={}}this._buttonGroupList[l.group]=k;var m=[],j;for(var h=0;h<l.buttons.length;h++){var f=document.createElement("li");f.className=this.CLASS_PREFIX+"-groupitem";k.appendChild(f);if((l.buttons[h].type!==undefined)&&l.buttons[h].type=="separator"){this.addSeparator(f)}else{l.buttons[h].container=f;j=this.addButton(l.buttons[h]);if(j){m[m.length]=j.id}}}return m},addButtonToGroup:function(h,i,j){var g=this._buttonGroupList[i],f=document.createElement("li");f.className=this.CLASS_PREFIX+"-groupitem";h.container=f;this.addButton(h,j);g.appendChild(f)},addButton:function(l,k){if(!this.get("element")){this._queue[this._queue.length]=["addButton",arguments];return false}if(!this._buttonList){this._buttonList=[]}if(!l.container){l.container=this.get("cont")}if((l.type=="menu")||(l.type=="split")||(l.type=="select")){if(e.isArray(l.menu)){for(var t in l.menu){if(e.hasOwnProperty(l.menu,t)){var z={fn:function(o,i,m){if(!l.menucmd){l.menucmd=l.value}l.value=((m.value)?m.value:m._oText.nodeValue)},scope:this};l.menu[t].onclick=z}}}}var u={},r=false;for(var p in l){if(e.hasOwnProperty(l,p)){if(!this._toolbarConfigs[p]){u[p]=l[p]}}}if(l.type=="select"){u.type="menu"}if(l.type=="spin"){u.type="push"}if(u.type=="color"){if(YAHOO.widget.Overlay){u=this._makeColorButton(u)}else{r=true}}if(u.menu){if((YAHOO.widget.Overlay)&&(l.menu instanceof YAHOO.widget.Overlay)){l.menu.showEvent.subscribe(function(){this._button=u})}else{for(var s=0;s<u.menu.length;s++){if(!u.menu[s].value){u.menu[s].value=u.menu[s].text}}if(this.browser.webkit){u.focusmenu=false}}}if(r){l=false}else{this._configs.buttons.value[this._configs.buttons.value.length]=l;var x=new this.buttonType(u);x.get("element").tabIndex="-1";x.get("element").setAttribute("role","button");x._selected=true;if(this.get("disabled")){x.set("disabled",true)}if(!l.id){l.id=x.get("id")}if(k){var g=x.get("element");var q=null;if(k.get){q=k.get("element").nextSibling}else{if(k.nextSibling){q=k.nextSibling}}if(q){q.parentNode.insertBefore(g,q)}}x.addClass(this.CLASS_PREFIX+"-"+x.get("value"));var w=document.createElement("span");w.className=this.CLASS_PREFIX+"-icon";x.get("element").insertBefore(w,x.get("firstChild"));if(x._button.tagName.toLowerCase()=="button"){x.get("element").setAttribute("unselectable","on");var y=document.createElement("a");y.innerHTML=x._button.innerHTML;y.href="#";y.tabIndex="-1";a.on(y,"click",function(i){a.stopEvent(i)});x._button.parentNode.replaceChild(y,x._button);x._button=y}if(l.type=="select"){if(x._button.tagName.toLowerCase()=="select"){w.parentNode.removeChild(w);var h=x._button,v=x.get("element");v.parentNode.replaceChild(h,v);x._configs.element.value=h}else{x.addClass(this.CLASS_PREFIX+"-select")}}if(l.type=="spin"){if(!e.isArray(l.range)){l.range=[10,100]}this._makeSpinButton(x,l)}x.get("element").setAttribute("title",x.get("label"));if(l.type!="spin"){if((YAHOO.widget.Overlay)&&(u.menu instanceof YAHOO.widget.Overlay)){var j=function(o){var i=true;if(o.keyCode&&(o.keyCode==9)){i=false}if(i){if(this._colorPicker){this._colorPicker._button=l.value}var m=x.getMenu().element;if(d.getStyle(m,"visibility")=="hidden"){x.getMenu().show()}else{x.getMenu().hide()}}YAHOO.util.Event.stopEvent(o)};x.on("mousedown",j,l,this);x.on("keydown",j,l,this)}else{if((l.type!="menu")&&(l.type!="select")){x.on("keypress",this._buttonClick,l,this);x.on("mousedown",function(i){YAHOO.util.Event.stopEvent(i);this._buttonClick(i,l)},l,this);x.on("click",function(i){YAHOO.util.Event.stopEvent(i)})}else{x.on("mousedown",function(i){YAHOO.util.Event.stopEvent(i)});x.on("click",function(i){YAHOO.util.Event.stopEvent(i)});x.on("change",function(i){if(!i.target){if(!l.menucmd){l.menucmd=l.value}l.value=i.value;this._buttonClick(i,l)}},this,true);var n=this;x.on("appendTo",function(){var i=this;if(i.getMenu()&&i.getMenu().mouseDownEvent){i.getMenu().mouseDownEvent.subscribe(function(A,o){var m=o[1];YAHOO.util.Event.stopEvent(o[0]);i._onMenuClick(o[0],i);if(!l.menucmd){l.menucmd=l.value}l.value=((m.value)?m.value:m._oText.nodeValue);n._buttonClick.call(n,o[1],l);i._hideMenu();return false});i.getMenu().clickEvent.subscribe(function(o,m){YAHOO.util.Event.stopEvent(m[0])});i.getMenu().mouseUpEvent.subscribe(function(o,m){YAHOO.util.Event.stopEvent(m[0])})}})}}}else{x.on("mousedown",function(i){YAHOO.util.Event.stopEvent(i)});x.on("click",function(i){YAHOO.util.Event.stopEvent(i)})}if(this.browser.ie){}if(this.browser.webkit){x.hasFocus=function(){return true}}this._buttonList[this._buttonList.length]=x;if((l.type=="menu")||(l.type=="split")||(l.type=="select")){if(e.isArray(l.menu)){var f=x.getMenu();if(f&&f.renderEvent){f.renderEvent.subscribe(this._addMenuClasses,x);if(l.renderer){f.renderEvent.subscribe(l.renderer,x)}}}}}return l},addSeparator:function(f,i){if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false}var g=((f)?f:this.get("cont"));if(!this.get("element")){this._queue[this._queue.length]=["addSeparator",arguments];return false}if(this._sepCount===null){this._sepCount=0}if(!this._sep){this._sep=document.createElement("SPAN");d.addClass(this._sep,this.CLASS_SEPARATOR);this._sep.innerHTML="|"}var h=this._sep.cloneNode(true);this._sepCount++;d.addClass(h,this.CLASS_SEPARATOR+"-"+this._sepCount);if(i){var j=null;if(i.get){j=i.get("element").nextSibling}else{if(i.nextSibling){j=i.nextSibling}else{j=i}}if(j){if(j==i){j.parentNode.appendChild(h)}else{j.parentNode.insertBefore(h,j)}}}else{g.appendChild(h)}return h},_createColorPicker:function(j){if(d.get(j+"_colors")){d.get(j+"_colors").parentNode.removeChild(d.get(j+"_colors"))}var f=document.createElement("div");f.className="yui-toolbar-colors";f.id=j+"_colors";f.style.display="none";a.on(window,"load",function(){document.body.appendChild(f)},this,true);this._colorPicker=f;var h="";for(var g in this._colorData){if(e.hasOwnProperty(this._colorData,g)){h+='<a style="background-color: '+g+'" href="#">'+g.replace("#","")+"</a>"}}h+="<span><em>X</em><strong></strong></span>";window.setTimeout(function(){f.innerHTML=h},0);a.on(f,"mouseover",function(n){var l=this._colorPicker;var m=l.getElementsByTagName("em")[0];var k=l.getElementsByTagName("strong")[0];var i=a.getTarget(n);if(i.tagName.toLowerCase()=="a"){m.style.backgroundColor=i.style.backgroundColor;k.innerHTML=this._colorData["#"+i.innerHTML]+"<br>"+i.innerHTML}},this,true);a.on(f,"focus",function(i){a.stopEvent(i)});a.on(f,"click",function(i){a.stopEvent(i)});a.on(f,"mousedown",function(k){a.stopEvent(k);var i=a.getTarget(k);if(i.tagName.toLowerCase()=="a"){var m=this.fireEvent("colorPickerClicked",{type:"colorPickerClicked",target:this,button:this._colorPicker._button,color:i.innerHTML,colorName:this._colorData["#"+i.innerHTML]});if(m!==false){var l={color:i.innerHTML,colorName:this._colorData["#"+i.innerHTML],value:this._colorPicker._button};this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:l})}this.getButtonByValue(this._colorPicker._button).getMenu().hide()}},this,true)},_resetColorPicker:function(){var g=this._colorPicker.getElementsByTagName("em")[0];var f=this._colorPicker.getElementsByTagName("strong")[0];g.style.backgroundColor="transparent";f.innerHTML=""},_makeColorButton:function(f){if(!this._colorPicker){this._createColorPicker(this.get("id"))}f.type="color";f.menu=new YAHOO.widget.Overlay(this.get("id")+"_"+f.value+"_menu",{visible:false,position:"absolute",iframe:true});f.menu.setBody("");f.menu.render(this.get("cont"));d.addClass(f.menu.element,"yui-button-menu");d.addClass(f.menu.element,"yui-color-button-menu");f.menu.beforeShowEvent.subscribe(function(){f.menu.cfg.setProperty("zindex",5);f.menu.cfg.setProperty("context",[this.getButtonById(f.id).get("element"),"tl","bl"]);this._resetColorPicker();var g=this._colorPicker;if(g.parentNode){g.parentNode.removeChild(g)}f.menu.setBody("");f.menu.appendToBody(g);this._colorPicker.style.display="block"},this,true);return f},_makeSpinButton:function(s,m){s.addClass(this.CLASS_PREFIX+"-spinbutton");var t=this,o=s._button.parentNode.parentNode,j=m.range,i=document.createElement("a"),h=document.createElement("a");i.href="#";h.href="#";i.tabIndex="-1";h.tabIndex="-1";i.className="up";i.title=this.STR_SPIN_UP;i.innerHTML=this.STR_SPIN_UP;h.className="down";h.title=this.STR_SPIN_DOWN;h.innerHTML=this.STR_SPIN_DOWN;o.appendChild(i);o.appendChild(h);var n=YAHOO.lang.substitute(this.STR_SPIN_LABEL,{VALUE:s.get("label")});s.set("title",n);var r=function(u){u=((u<j[0])?j[0]:u);u=((u>j[1])?j[1]:u);return u};var q=this.browser;var g=false;var l=this.STR_SPIN_LABEL;if(this._titlebar&&this._titlebar.firstChild){g=this._titlebar.firstChild}var f=function(v){YAHOO.util.Event.stopEvent(v);if(!s.get("disabled")&&(v.keyCode!=9)){var w=parseInt(s.get("label"),10);w++;w=r(w);s.set("label",""+w);var u=YAHOO.lang.substitute(l,{VALUE:s.get("label")});s.set("title",u);if(!q.webkit&&g){}t._buttonClick(v,m)}};var p=function(v){YAHOO.util.Event.stopEvent(v);if(!s.get("disabled")&&(v.keyCode!=9)){var w=parseInt(s.get("label"),10);w--;w=r(w);s.set("label",""+w);var u=YAHOO.lang.substitute(l,{VALUE:s.get("label")});s.set("title",u);if(!q.webkit&&g){}t._buttonClick(v,m)}};var k=function(u){if(u.keyCode==38){f(u)}else{if(u.keyCode==40){p(u)}else{if(u.keyCode==107&&u.shiftKey){f(u)}else{if(u.keyCode==109&&u.shiftKey){p(u)}}}}};s.on("keydown",k,this,true);a.on(i,"mousedown",function(u){a.stopEvent(u)},this,true);a.on(h,"mousedown",function(u){a.stopEvent(u)},this,true);a.on(i,"click",f,this,true);a.on(h,"click",p,this,true)},_buttonClick:function(o,g){var f=true;if(o&&o.type=="keypress"){if(o.keyCode==9){f=false}else{if((o.keyCode===13)||(o.keyCode===0)||(o.keyCode===32)){}else{f=false}}}if(f){var q=true,j=false;g.isSelected=this.isSelected(g.id);if(g.value){j=this.fireEvent(g.value+"Click",{type:g.value+"Click",target:this.get("element"),button:g});if(j===false){q=false}}if(g.menucmd&&q){j=this.fireEvent(g.menucmd+"Click",{type:g.menucmd+"Click",target:this.get("element"),button:g});if(j===false){q=false}}if(q){this.fireEvent("buttonClick",{type:"buttonClick",target:this.get("element"),button:g})}if(g.type=="select"){var n=this.getButtonById(g.id);if(n.buttonType=="rich"){var l=g.value;for(var k=0;k<g.menu.length;k++){if(g.menu[k].value==g.value){l=g.menu[k].text;break}}n.set("label",'<span class="yui-toolbar-'+g.menucmd+"-"+(g.value).replace(/ /g,"-").toLowerCase()+'">'+l+"</span>");var p=n.getMenu().getItems();for(var h=0;h<p.length;h++){if(p[h].value.toLowerCase()==g.value.toLowerCase()){p[h].cfg.setProperty("checked",true)}else{p[h].cfg.setProperty("checked",false)}}}}if(o){a.stopEvent(o)}}},_keyNav:null,_navCounter:null,_navigateButtons:function(g){switch(g.keyCode){case 37:case 39:if(g.keyCode==37){this._navCounter--}else{this._navCounter++}if(this._navCounter>(this._buttonList.length-1)){this._navCounter=0}if(this._navCounter<0){this._navCounter=(this._buttonList.length-1)}if(this._buttonList[this._navCounter]){var f=this._buttonList[this._navCounter].get("element");if(this.browser.ie){f=this._buttonList[this._navCounter].get("element").getElementsByTagName("a")[0]}if(this._buttonList[this._navCounter].get("disabled")){this._navigateButtons(g)}else{f.focus()}}break}},_handleFocus:function(){if(!this._keyNav){var f="keypress";if(this.browser.ie){f="keydown"}a.on(this.get("element"),f,this._navigateButtons,this,true);this._keyNav=true;this._navCounter=-1}},getButtonById:function(h){var f=this._buttonList.length;for(var g=0;g<f;g++){if(this._buttonList[g]&&this._buttonList[g].get("id")==h){return this._buttonList[g]}}return false},getButtonByValue:function(o){var k=this.get("buttons");if(!k){return false}var g=k.length;for(var l=0;l<g;l++){if(k[l].group!==undefined){for(var f=0;f<k[l].buttons.length;f++){if((k[l].buttons[f].value==o)||(k[l].buttons[f].menucmd==o)){return this.getButtonById(k[l].buttons[f].id)}if(k[l].buttons[f].menu){for(var n=0;n<k[l].buttons[f].menu.length;n++){if(k[l].buttons[f].menu[n].value==o){return this.getButtonById(k[l].buttons[f].id)}}}}}else{if((k[l].value==o)||(k[l].menucmd==o)){return this.getButtonById(k[l].id)}if(k[l].menu){for(var h=0;h<k[l].menu.length;h++){if(k[l].menu[h].value==o){return this.getButtonById(k[l].id)}}}}}return false},getButtonByIndex:function(f){if(this._buttonList[f]){return this._buttonList[f]}else{return false}},getButtons:function(){return this._buttonList},disableButton:function(g){var f=c.call(this,g);if(f){f.set("disabled",true)}else{return false}},enableButton:function(g){if(this.get("disabled")){return false}var f=c.call(this,g);if(f){if(f.get("disabled")){f.set("disabled",false)}}else{return false}},isSelected:function(g){var f=c.call(this,g);if(f){return f._selected}return false},selectButton:function(j,h){var g=c.call(this,j);if(g){g.addClass("yui-button-selected");g.addClass("yui-button-"+g.get("value")+"-selected");g._selected=true;if(h){if(g.buttonType=="rich"){var i=g.getMenu().getItems();for(var f=0;f<i.length;f++){if(i[f].value==h){i[f].cfg.setProperty("checked",true);g.set("label",'<span class="yui-toolbar-'+g.get("value")+"-"+(h).replace(/ /g,"-").toLowerCase()+'">'+i[f]._oText.nodeValue+"</span>")}else{i[f].cfg.setProperty("checked",false)}}}}}else{return false}},deselectButton:function(g){var f=c.call(this,g);if(f){f.removeClass("yui-button-selected");f.removeClass("yui-button-"+f.get("value")+"-selected");f.removeClass("yui-button-hover");f._selected=false}else{return false}},deselectAllButtons:function(){var f=this._buttonList.length;for(var g=0;g<f;g++){this.deselectButton(this._buttonList[g])}},disableAllButtons:function(){if(this.get("disabled")){return false}var f=this._buttonList.length;for(var g=0;g<f;g++){this.disableButton(this._buttonList[g])}},enableAllButtons:function(){if(this.get("disabled")){return false}var f=this._buttonList.length;for(var g=0;g<f;g++){this.enableButton(this._buttonList[g])}},resetAllButtons:function(k){if(!e.isObject(k)){k={}}if(this.get("disabled")||!this._buttonList){return false}var f=this._buttonList.length;for(var g=0;g<f;g++){var j=this._buttonList[g];if(j){var h=j._configs.disabled._initialConfig.value;if(k[j.get("id")]){this.enableButton(j);this.selectButton(j)}else{if(h){this.disableButton(j)}else{this.enableButton(j)}this.deselectButton(j)}}}},destroyButton:function(l){var j=c.call(this,l);if(j){var k=j.get("id"),g=[],h=0,f=this._buttonList.length;j.destroy();for(h=0;h<f;h++){if(this._buttonList[h].get("id")!=k){g[g.length]=this._buttonList[h]}}this._buttonList=g}else{return false}},destroy:function(){var f=this._configuredButtons.length,g,h;for(b=0;b<f;b++){this.destroyButton(this._configuredButtons[b])}this._configuredButtons=null;this.get("element").innerHTML="";this.get("element").className="";for(h in this){if(e.hasOwnProperty(this,h)){this[h]=null}}return true},collapse:function(g){var f=d.getElementsByClassName("collapse","span",this._titlebar);if(g===false){d.removeClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");if(f[0]){d.removeClass(f[0],"collapsed");f[0].title=this.STR_COLLAPSE}this.fireEvent("toolbarExpanded",{type:"toolbarExpanded",target:this})}else{if(f[0]){d.addClass(f[0],"collapsed");f[0].title=this.STR_EXPAND}d.addClass(this.get("cont").parentNode,"yui-toolbar-container-collapsed");this.fireEvent("toolbarCollapsed",{type:"toolbarCollapsed",target:this})}},toString:function(){return"Toolbar (#"+this.get("element").id+") with "+this._buttonList.length+" buttons."}})})();(function(){var d=YAHOO.util.Dom,a=YAHOO.util.Event,e=YAHOO.lang,c=YAHOO.widget.Toolbar;YAHOO.widget.SimpleEditor=function(i,n){var h={};if(e.isObject(i)&&(!i.tagName)&&!n){e.augmentObject(h,i);i=document.createElement("textarea");this.DOMReady=true;if(h.container){var l=d.get(h.container);l.appendChild(i)}else{document.body.appendChild(i)}}else{if(n){e.augmentObject(h,n)}}var j={element:null,attributes:h},g=null;if(e.isString(i)){g=i}else{if(j.attributes.id){g=j.attributes.id}else{this.DOMReady=true;g=d.generateId(i)}}j.element=i;var k=document.createElement("DIV");j.attributes.element_cont=new YAHOO.util.Element(k,{id:g+"_container"});var f=document.createElement("div");d.addClass(f,"first-child");j.attributes.element_cont.appendChild(f);if(!j.attributes.toolbar_cont){j.attributes.toolbar_cont=document.createElement("DIV");j.attributes.toolbar_cont.id=g+"_toolbar";f.appendChild(j.attributes.toolbar_cont)}var m=document.createElement("DIV");f.appendChild(m);j.attributes.editor_wrapper=m;YAHOO.widget.SimpleEditor.superclass.constructor.call(this,j.element,j.attributes)};YAHOO.extend(YAHOO.widget.SimpleEditor,YAHOO.util.Element,{_resizeConfig:{handles:["br"],autoRatio:true,status:true,proxy:true,useShim:true,setSize:false},_setupResize:function(){if(!YAHOO.util.DD||!YAHOO.util.Resize){return false}if(this.get("resize")){var f={};e.augmentObject(f,this._resizeConfig);this.resize=new YAHOO.util.Resize(this.get("element_cont").get("element"),f);this.resize.on("resize",function(i){var m=this.get("animate");this.set("animate",false);this.set("width",i.width+"px");var j=i.height,k=(this.toolbar.get("element").clientHeight+2),l=0;if(this.dompath){l=(this.dompath.clientHeight+1)}var g=(j-k-l);this.set("height",g+"px");this.get("element_cont").setStyle("height","");this.set("animate",m)},this,true)}},resize:null,_setupDD:function(){if(!YAHOO.util.DD){return false}if(this.get("drag")){var g=this.get("drag"),f=YAHOO.util.DD;if(g==="proxy"){f=YAHOO.util.DDProxy}this.dd=new f(this.get("element_cont").get("element"));this.toolbar.addClass("draggable");this.dd.setHandleElId(this.toolbar._titlebar)}},dd:null,_lastCommand:null,_undoNodeChange:function(){},_storeUndo:function(){},_checkKey:function(f,j){var g=false;if((j.keyCode===f.key)){if(f.mods&&(f.mods.length>0)){var l=0;for(var h=0;h<f.mods.length;h++){if(this.browser.mac){if(f.mods[h]=="ctrl"){f.mods[h]="meta"}}if(j[f.mods[h]+"Key"]===true){l++}}if(l===f.mods.length){g=true}}else{g=true}}return g},_keyMap:{SELECT_ALL:{key:65,mods:["ctrl"]},CLOSE_WINDOW:{key:87,mods:["shift","ctrl"]},FOCUS_TOOLBAR:{key:27,mods:["shift"]},FOCUS_AFTER:{key:27},FONT_SIZE_UP:{key:38,mods:["shift","ctrl"]},FONT_SIZE_DOWN:{key:40,mods:["shift","ctrl"]},CREATE_LINK:{key:76,mods:["shift","ctrl"]},BOLD:{key:66,mods:["shift","ctrl"]},ITALIC:{key:73,mods:["shift","ctrl"]},UNDERLINE:{key:85,mods:["shift","ctrl"]},UNDO:{key:90,mods:["ctrl"]},REDO:{key:90,mods:["shift","ctrl"]},JUSTIFY_LEFT:{key:219,mods:["shift","ctrl"]},JUSTIFY_CENTER:{key:220,mods:["shift","ctrl"]},JUSTIFY_RIGHT:{key:221,mods:["shift","ctrl"]}},_cleanClassName:function(f){return f.replace(/ /g,"-").toLowerCase()},_textarea:null,_docType:'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">',editorDirty:null,_defaultCSS:"html { height: 95%; } body { padding: 7px; background-color: #fff; font: 13px/1.22 arial,helvetica,clean,sans-serif;*font-size:small;*font:x-small; } a, a:visited, a:hover { color: blue !important; text-decoration: underline !important; cursor: text !important; } .warning-localfile { border-bottom: 1px dashed red !important; } .yui-busy { cursor: wait !important; } img.selected { border: 2px dotted #808080; } img { cursor: pointer !important; border: none; } body.ptags.webkit div.yui-wk-p { margin: 11px 0; } body.ptags.webkit div.yui-wk-div { margin: 0; }",_defaultToolbar:null,_lastButton:null,_baseHREF:function(){var f=document.location.href;if(f.indexOf("?")!==-1){f=f.substring(0,f.indexOf("?"))}f=f.substring(0,f.lastIndexOf("/"))+"/";return f}(),_lastImage:null,_blankImageLoaded:null,_fixNodesTimer:null,_nodeChangeTimer:null,_nodeChangeDelayTimer:null,_lastNodeChangeEvent:null,_lastNodeChange:0,_rendered:null,DOMReady:null,_selection:null,_mask:null,_showingHiddenElements:null,currentWindow:null,currentEvent:null,operaEvent:null,currentFont:null,currentElement:null,dompath:null,beforeElement:null,afterElement:null,invalidHTML:{form:true,input:true,button:true,select:true,link:true,html:true,body:true,iframe:true,script:true,style:true,textarea:true},toolbar:null,_contentTimer:null,_contentTimerMax:500,_contentTimerCounter:0,_disabled:["createlink","fontname","fontsize","forecolor","backcolor"],_alwaysDisabled:{undo:true,redo:true},_alwaysEnabled:{},_semantic:{bold:true,italic:true,underline:true},_tag2cmd:{b:"bold",strong:"bold",i:"italic",em:"italic",u:"underline",sup:"superscript",sub:"subscript",img:"insertimage",a:"createlink",ul:"insertunorderedlist",ol:"insertorderedlist"},_createIframe:function(){var k=document.createElement("iframe");k.id=this.get("id")+"_editor";var h={border:"0",frameBorder:"0",marginWidth:"0",marginHeight:"0",leftMargin:"0",topMargin:"0",allowTransparency:"true",width:"100%"};if(this.get("autoHeight")){h.scrolling="no"}for(var j in h){if(e.hasOwnProperty(h,j)){k.setAttribute(j,h[j])}}var g="javascript:;";if(this.browser.ie){g="javascript:false;"}k.setAttribute("src",g);var f=new YAHOO.util.Element(k);f.setStyle("visibility","hidden");return f},_isElement:function(g,f){if(g&&g.tagName&&(g.tagName.toLowerCase()==f)){return true}if(g&&g.getAttribute&&(g.getAttribute("tag")==f)){return true}return false},_hasParent:function(g,f){if(!g||!g.parentNode){return false}while(g.parentNode){if(this._isElement(g,f)){return g}if(g.parentNode){g=g.parentNode}else{return false}}return false},_getDoc:function(){var f=false;try{if(this.get("iframe").get("element").contentWindow.document){f=this.get("iframe").get("element").contentWindow.document;return f}}catch(g){return false}},_getWindow:function(){return this.get("iframe").get("element").contentWindow},focus:function(){this._getWindow().focus()},_focusWindow:function(){this.focus()},_hasSelection:function(){var h=this._getSelection();var f=this._getRange();var g=false;if(!h||!f){return g}if(this.browser.ie||this.browser.opera){if(f.text){g=true}if(f.html){g=true}}else{if(this.browser.webkit){if(h+""!==""){g=true}}else{if(h&&(h.toString()!=="")&&(h!==undefined)){g=true}}}return g},_getSelection:function(){var f=null;if(this._getDoc()&&this._getWindow()){if(this._getDoc().selection){f=this._getDoc().selection}else{f=this._getWindow().getSelection()}if(this.browser.webkit){if(f.baseNode){this._selection={};this._selection.baseNode=f.baseNode;this._selection.baseOffset=f.baseOffset;this._selection.extentNode=f.extentNode;this._selection.extentOffset=f.extentOffset}else{if(this._selection!==null){f=this._getWindow().getSelection();f.setBaseAndExtent(this._selection.baseNode,this._selection.baseOffset,this._selection.extentNode,this._selection.extentOffset);this._selection=null}}}}return f},_selectNode:function(g,j){if(!g){return false}var h=this._getSelection(),f=null;if(this.browser.ie){try{f=this._getDoc().body.createTextRange();f.moveToElementText(g);f.select()}catch(i){}}else{if(this.browser.webkit){if(j){h.setBaseAndExtent(g,1,g,g.innerText.length)}else{h.setBaseAndExtent(g,0,g,g.innerText.length)}}else{if(this.browser.opera){h=this._getWindow().getSelection();f=this._getDoc().createRange();f.selectNode(g);h.removeAllRanges();h.addRange(f)}else{f=this._getDoc().createRange();f.selectNodeContents(g);h.removeAllRanges();h.addRange(f)}}}this.nodeChange()},_getRange:function(){var f=this._getSelection();if(f===null){return null}if(this.browser.webkit&&!f.getRangeAt){var i=this._getDoc().createRange();try{i.setStart(f.anchorNode,f.anchorOffset);i.setEnd(f.focusNode,f.focusOffset)}catch(h){i=this._getWindow().getSelection()+""}return i}if(this.browser.ie||this.browser.opera){try{return f.createRange()}catch(g){return null}}if(f.rangeCount>0){return f.getRangeAt(0)}return null},_setDesignMode:function(f){if(this.get("setDesignMode")){try{this._getDoc().designMode=((f.toLowerCase()=="off")?"off":"on")}catch(g){}}},_toggleDesignMode:function(){var g=this._getDoc().designMode,f=((g.toLowerCase()=="on")?"off":"on");this._setDesignMode(f);return f},_focused:null,_handleFocus:function(f){if(!this._focused){this._focused=true;this.fireEvent("editorWindowFocus",{type:"editorWindowFocus",target:this})}},_handleBlur:function(f){if(this._focused){this._focused=false;this.fireEvent("editorWindowBlur",{type:"editorWindowBlur",target:this})}},_initEditorEvents:function(){var g=this._getDoc(),f=this._getWindow();a.on(g,"mouseup",this._handleMouseUp,this,true);a.on(g,"mousedown",this._handleMouseDown,this,true);a.on(g,"click",this._handleClick,this,true);a.on(g,"dblclick",this._handleDoubleClick,this,true);a.on(g,"keypress",this._handleKeyPress,this,true);a.on(g,"keyup",this._handleKeyUp,this,true);a.on(g,"keydown",this._handleKeyDown,this,true);a.on(f,"focus",this._handleFocus,this,true);a.on(f,"blur",this._handleBlur,this,true)},_removeEditorEvents:function(){var g=this._getDoc(),f=this._getWindow();a.removeListener(g,"mouseup",this._handleMouseUp,this,true);a.removeListener(g,"mousedown",this._handleMouseDown,this,true);a.removeListener(g,"click",this._handleClick,this,true);a.removeListener(g,"dblclick",this._handleDoubleClick,this,true);a.removeListener(g,"keypress",this._handleKeyPress,this,true);a.removeListener(g,"keyup",this._handleKeyUp,this,true);a.removeListener(g,"keydown",this._handleKeyDown,this,true);a.removeListener(f,"focus",this._handleFocus,this,true);a.removeListener(f,"blur",this._handleBlur,this,true)},_fixWebkitDivs:function(){if(this.browser.webkit){var f=this._getDoc().body.getElementsByTagName("div");d.addClass(f,"yui-wk-div")}},_initEditor:function(g){if(this._editorInit){return}this._editorInit=true;if(this.browser.ie){this._getDoc().body.style.margin="0"}if(!this.get("disabled")){this._setDesignMode("on");this._contentTimerCounter=0}if(!this._getDoc().body){this._contentTimerCounter=0;this._editorInit=false;this._checkLoaded();return false}if(!g){this.toolbar.on("buttonClick",this._handleToolbarClick,this,true)}if(!this.get("disabled")){this._initEditorEvents();this.toolbar.set("disabled",false)}if(g){this.fireEvent("editorContentReloaded",{type:"editorreloaded",target:this})}else{this.fireEvent("editorContentLoaded",{type:"editorLoaded",target:this})}this._fixWebkitDivs();if(this.get("dompath")){var f=this;setTimeout(function(){f._writeDomPath.call(f);f._setupResize.call(f)},150)}var j=[];for(var h in this.browser){if(this.browser[h]){j.push(h)}}if(this.get("ptags")){j.push("ptags")}d.addClass(this._getDoc().body,j.join(" "));this.nodeChange(true)},_checkLoaded:function(g){this._editorInit=false;this._contentTimerCounter++;if(this._contentTimer){clearTimeout(this._contentTimer)}if(this._contentTimerCounter>this._contentTimerMax){return false}var i=false;try{if(this._getDoc()&&this._getDoc().body){if(this.browser.ie){if(this._getDoc().body.readyState=="complete"){i=true}}else{if(this._getDoc().body._rteLoaded===true){i=true}}}}catch(h){i=false}if(i===true){this._initEditor(g)}else{var f=this;this._contentTimer=setTimeout(function(){f._checkLoaded.call(f,g)},20)}},_setInitialContent:function(g){var j=((this._textarea)?this.get("element").value:this.get("element").innerHTML),l=null;if(j===""){j="<br>"}var h=e.substitute(this.get("html"),{TITLE:this.STR_TITLE,CONTENT:this._cleanIncomingHTML(j),CSS:this.get("css"),HIDDEN_CSS:((this.get("hiddencss"))?this.get("hiddencss"):"/* No Hidden CSS */"),EXTRA_CSS:((this.get("extracss"))?this.get("extracss"):"/* No Extra CSS */")}),f=true;h=h.replace(/RIGHT_BRACKET/gi,"{");h=h.replace(/LEFT_BRACKET/gi,"}");if(document.compatMode!="BackCompat"){h=this._docType+"\n"+h}else{}if(this.browser.ie||this.browser.webkit||this.browser.opera||(navigator.userAgent.indexOf("Firefox/1.5")!=-1)){try{if(this.browser.air){l=this._getDoc().implementation.createHTMLDocument();var m=this._getDoc();m.open();m.close();l.open();l.write(h);l.close();var i=m.importNode(l.getElementsByTagName("html")[0],true);m.replaceChild(i,m.getElementsByTagName("html")[0]);m.body._rteLoaded=true}else{l=this._getDoc();l.open();l.write(h);l.close()}}catch(k){f=false}}else{this.get("iframe").get("element").src="data:text/html;charset=utf-8,"+encodeURIComponent(h)}this.get("iframe").setStyle("visibility","");if(f){this._checkLoaded(g)}},_setMarkupType:function(f){switch(this.get("markup")){case"css":this._setEditorStyle(true);break;case"default":this._setEditorStyle(false);break;case"semantic":case"xhtml":if(this._semantic[f]){this._setEditorStyle(false)}else{this._setEditorStyle(true)}break}},_setEditorStyle:function(g){try{this._getDoc().execCommand("useCSS",false,!g)}catch(f){}},_getSelectedElement:function(){var k=this._getDoc(),h=null,i=null,l=null,g=true;if(this.browser.ie){this.currentEvent=this._getWindow().event;h=this._getRange();if(h){l=h.item?h.item(0):h.parentElement();if(this._hasSelection()){}if(l===k.body){l=null}}if((this.currentEvent!==null)&&(this.currentEvent.keyCode===0)){l=a.getTarget(this.currentEvent)}}else{i=this._getSelection();h=this._getRange();if(!i||!h){return null}if(!this._hasSelection()&&this.browser.webkit3){}if(this.browser.gecko){if(h.startContainer){if(h.startContainer.nodeType===3){l=h.startContainer.parentNode}else{if(h.startContainer.nodeType===1){l=h.startContainer}}if(this.currentEvent){var f=a.getTarget(this.currentEvent);if(!this._isElement(f,"html")){if(l!==f){l=f}}}}}if(g){if(i.anchorNode&&(i.anchorNode.nodeType==3)){if(i.anchorNode.parentNode){l=i.anchorNode.parentNode}if(i.anchorNode.nextSibling!=i.focusNode.nextSibling){l=i.anchorNode.nextSibling}}if(this._isElement(l,"br")){l=null}if(!l){l=h.commonAncestorContainer;if(!h.collapsed){if(h.startContainer==h.endContainer){if(h.startOffset-h.endOffset<2){if(h.startContainer.hasChildNodes()){l=h.startContainer.childNodes[h.startOffset]}}}}}}}if(this.currentEvent!==null){try{switch(this.currentEvent.type){case"click":case"mousedown":case"mouseup":if(this.browser.webkit){l=a.getTarget(this.currentEvent)}break;default:break}}catch(j){}}else{if((this.currentElement&&this.currentElement[0])&&(!this.browser.ie)){}}if(this.browser.opera||this.browser.webkit){if(this.currentEvent&&!l){l=YAHOO.util.Event.getTarget(this.currentEvent)}}if(!l||!l.tagName){l=k.body}if(this._isElement(l,"html")){l=k.body}if(this._isElement(l,"body")){l=k.body}if(l&&!l.parentNode){l=k.body}if(l===undefined){l=null}return l},_getDomPath:function(f){if(!f){f=this._getSelectedElement()}var g=[];while(f!==null){if(f.ownerDocument!=this._getDoc()){f=null;break}if(f.nodeName&&f.nodeType&&(f.nodeType==1)){g[g.length]=f}if(this._isElement(f,"body")){break}f=f.parentNode}if(g.length===0){if(this._getDoc()&&this._getDoc().body){g[0]=this._getDoc().body}}return g.reverse()},_writeDomPath:function(){var n=this._getDomPath(),l=[],j="",o="";for(var f=0;f<n.length;f++){var p=n[f].tagName.toLowerCase();if((p=="ol")&&(n[f].type)){p+=":"+n[f].type}if(d.hasClass(n[f],"yui-tag")){p=n[f].getAttribute("tag")}if((this.get("markup")=="semantic")||(this.get("markup")=="xhtml")){switch(p){case"b":p="strong";break;case"i":p="em";break}}if(!d.hasClass(n[f],"yui-non")){if(d.hasClass(n[f],"yui-tag")){o=p}else{j=((n[f].className!=="")?"."+n[f].className.replace(/ /g,"."):"");if((j.indexOf("yui")!=-1)||(j.toLowerCase().indexOf("apple-style-span")!=-1)){j=""}o=p+((n[f].id)?"#"+n[f].id:"")+j}switch(p){case"body":o="body";break;case"a":if(n[f].getAttribute("href",2)){o+=":"+n[f].getAttribute("href",2).replace("mailto:","").replace("http://","").replace("https://","")}break;case"img":var g=n[f].height;var m=n[f].width;if(n[f].style.height){g=parseInt(n[f].style.height,10)}if(n[f].style.width){m=parseInt(n[f].style.width,10)}o+="("+m+"x"+g+")";break}if(o.length>10){o='<span title="'+o+'">'+o.substring(0,10)+"...</span>"}else{o='<span title="'+o+'">'+o+"</span>"}l[l.length]=o}}var k=l.join(" "+this.SEP_DOMPATH+" ");if(this.dompath.innerHTML!=k){this.dompath.innerHTML=k}},_fixNodes:function(){try{var n=this._getDoc(),k=[];for(var f in this.invalidHTML){if(YAHOO.lang.hasOwnProperty(this.invalidHTML,f)){if(f.toLowerCase()!="span"){var g=n.body.getElementsByTagName(f);if(g.length){for(var j=0;j<g.length;j++){k.push(g[j])}}}}}for(var l=0;l<k.length;l++){if(k[l].parentNode){if(e.isObject(this.invalidHTML[k[l].tagName.toLowerCase()])&&this.invalidHTML[k[l].tagName.toLowerCase()].keepContents){this._swapEl(k[l],"span",function(h){h.className="yui-non"})}else{k[l].parentNode.removeChild(k[l])}}}var o=this._getDoc().getElementsByTagName("img");d.addClass(o,"yui-img")}catch(m){}},_isNonEditable:function(h){if(this.get("allowNoEdit")){var g=a.getTarget(h);if(this._isElement(g,"html")){g=null}var l=this._getDomPath(g);for(var f=(l.length-1);f>-1;f--){if(d.hasClass(l[f],this.CLASS_NOEDIT)){try{this._getDoc().execCommand("enableObjectResizing",false,"false")}catch(k){}this.nodeChange();a.stopEvent(h);return true}}try{this._getDoc().execCommand("enableObjectResizing",false,"true")}catch(j){}}return false},_setCurrentEvent:function(f){this.currentEvent=f},_handleClick:function(h){var g=this.fireEvent("beforeEditorClick",{type:"beforeEditorClick",target:this,ev:h});if(g===false){return false}if(this._isNonEditable(h)){return false}this._setCurrentEvent(h);if(this.currentWindow){this.closeWindow()}if(this.currentWindow){this.closeWindow()}if(this.browser.webkit){var f=a.getTarget(h);if(this._isElement(f,"a")||this._isElement(f.parentNode,"a")){a.stopEvent(h);this.nodeChange()}}else{this.nodeChange()}this.fireEvent("editorClick",{type:"editorClick",target:this,ev:h})},_handleMouseUp:function(h){var g=this.fireEvent("beforeEditorMouseUp",{type:"beforeEditorMouseUp",target:this,ev:h});if(g===false){return false}if(this._isNonEditable(h)){return false}var f=this;if(this.browser.opera){var i=a.getTarget(h);if(this._isElement(i,"img")){this.nodeChange();if(this.operaEvent){clearTimeout(this.operaEvent);this.operaEvent=null;this._handleDoubleClick(h)}else{this.operaEvent=window.setTimeout(function(){f.operaEvent=false},700)}}}if(this.browser.webkit||this.browser.opera){if(this.browser.webkit){a.stopEvent(h)}}this.nodeChange();this.fireEvent("editorMouseUp",{type:"editorMouseUp",target:this,ev:h})},_handleMouseDown:function(g){var f=this.fireEvent("beforeEditorMouseDown",{type:"beforeEditorMouseDown",target:this,ev:g});if(f===false){return false}if(this._isNonEditable(g)){return false}this._setCurrentEvent(g);var h=a.getTarget(g);if(this.browser.webkit&&this._hasSelection()){var i=this._getSelection();if(!this.browser.webkit3){i.collapse(true)}else{i.collapseToStart()}}if(this.browser.webkit&&this._lastImage){d.removeClass(this._lastImage,"selected");this._lastImage=null}if(this._isElement(h,"img")||this._isElement(h,"a")){if(this.browser.webkit){a.stopEvent(g);if(this._isElement(h,"img")){d.addClass(h,"selected");this._lastImage=h}}if(this.currentWindow){this.closeWindow()}this.nodeChange()}this.fireEvent("editorMouseDown",{type:"editorMouseDown",target:this,ev:g})},_handleDoubleClick:function(g){var f=this.fireEvent("beforeEditorDoubleClick",{type:"beforeEditorDoubleClick",target:this,ev:g});if(f===false){return false}if(this._isNonEditable(g)){return false}this._setCurrentEvent(g);var h=a.getTarget(g);if(this._isElement(h,"img")){this.currentElement[0]=h;this.toolbar.fireEvent("insertimageClick",{type:"insertimageClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this})}else{if(this._hasParent(h,"a")){this.currentElement[0]=this._hasParent(h,"a");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this})}}this.nodeChange();this.fireEvent("editorDoubleClick",{type:"editorDoubleClick",target:this,ev:g})},_handleKeyUp:function(h){var g=this.fireEvent("beforeEditorKeyUp",{type:"beforeEditorKeyUp",target:this,ev:h});if(g===false){return false}if(this._isNonEditable(h)){return false}this._storeUndo();this._setCurrentEvent(h);switch(h.keyCode){case this._keyMap.SELECT_ALL.key:if(this._checkKey(this._keyMap.SELECT_ALL,h)){this.nodeChange()}break;case 32:case 35:case 36:case 37:case 38:case 39:case 40:case 46:case 8:case this._keyMap.CLOSE_WINDOW.key:if((h.keyCode==this._keyMap.CLOSE_WINDOW.key)&&this.currentWindow){if(this._checkKey(this._keyMap.CLOSE_WINDOW,h)){this.closeWindow()}}else{if(!this.browser.ie){if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer)}var f=this;this._nodeChangeTimer=setTimeout(function(){f._nodeChangeTimer=null;f.nodeChange.call(f)},100)}else{this.nodeChange()}this.editorDirty=true}break}this.fireEvent("editorKeyUp",{type:"editorKeyUp",target:this,ev:h})},_handleKeyPress:function(h){var g=this.fireEvent("beforeEditorKeyPress",{type:"beforeEditorKeyPress",target:this,ev:h});if(g===false){return false}if(this.get("allowNoEdit")){if(h&&h.keyCode&&(h.keyCode==63272)){a.stopEvent(h)}}if(this._isNonEditable(h)){return false}this._setCurrentEvent(h);this._storeUndo();if(this.browser.opera){if(h.keyCode===13){var f=this._getSelectedElement();if(!this._isElement(f,"li")){this.execCommand("inserthtml","<br>");a.stopEvent(h)}}}if(this.browser.webkit){if(!this.browser.webkit3){if(h.keyCode&&(h.keyCode==122)&&(h.metaKey)){if(this._hasParent(this._getSelectedElement(),"li")){a.stopEvent(h)}}}this._listFix(h)}this._fixListDupIds();this.fireEvent("editorKeyPress",{type:"editorKeyPress",target:this,ev:h})},_handleKeyDown:function(B){var D=this.fireEvent("beforeEditorKeyDown",{type:"beforeEditorKeyDown",target:this,ev:B});if(D===false){return false}var y=null,f=null;if(this._isNonEditable(B)){return false}this._setCurrentEvent(B);if(this.currentWindow){this.closeWindow()}if(this.currentWindow){this.closeWindow()}var r=false,w=null,t=null,v=false;switch(B.keyCode){case this._keyMap.FOCUS_TOOLBAR.key:if(this._checkKey(this._keyMap.FOCUS_TOOLBAR,B)){var A=this.toolbar.getElementsByTagName("h2")[0];if(A&&A.firstChild){A.firstChild.focus()}}else{if(this._checkKey(this._keyMap.FOCUS_AFTER,B)){this.afterElement.focus()}}a.stopEvent(B);r=false;break;case this._keyMap.CREATE_LINK.key:if(this._hasSelection()){if(this._checkKey(this._keyMap.CREATE_LINK,B)){var g=true;if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("createlink")){g=false}}if(g){this.execCommand("createlink","");this.toolbar.fireEvent("createlinkClick",{type:"createlinkClick",target:this.toolbar});this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this});r=false}}}break;case this._keyMap.UNDO.key:case this._keyMap.REDO.key:if(this._checkKey(this._keyMap.REDO,B)){w="redo";r=true}else{if(this._checkKey(this._keyMap.UNDO,B)){w="undo";r=true}}break;case this._keyMap.BOLD.key:if(this._checkKey(this._keyMap.BOLD,B)){w="bold";r=true}break;case this._keyMap.FONT_SIZE_UP.key:case this._keyMap.FONT_SIZE_DOWN.key:var n=false,x=false;if(this._checkKey(this._keyMap.FONT_SIZE_UP,B)){n=true}if(this._checkKey(this._keyMap.FONT_SIZE_DOWN,B)){x=true}if(n||x){var k=this.toolbar.getButtonByValue("fontsize"),j=parseInt(k.get("label"),10),l=(j+1);if(x){l=(j-1)}w="fontsize";t=l+"px";r=true}break;case this._keyMap.ITALIC.key:if(this._checkKey(this._keyMap.ITALIC,B)){w="italic";r=true}break;case this._keyMap.UNDERLINE.key:if(this._checkKey(this._keyMap.UNDERLINE,B)){w="underline";r=true}break;case 9:if(this.browser.ie){f=this._getRange();y=this._getSelectedElement();if(!this._isElement(y,"li")){if(f){f.pasteHTML("&nbsp;&nbsp;&nbsp;&nbsp;");f.collapse(false);f.select()}a.stopEvent(B)}}if(this.browser.gecko>1.8){y=this._getSelectedElement();if(this._isElement(y,"li")){if(B.shiftKey){this._getDoc().execCommand("outdent",null,"")}else{this._getDoc().execCommand("indent",null,"")}}else{if(!this._hasSelection()){this.execCommand("inserthtml","&nbsp;&nbsp;&nbsp;&nbsp;")}}a.stopEvent(B)}break;case 13:var q=null,z=0;if(this.get("ptags")&&!B.shiftKey){if(this.browser.gecko){y=this._getSelectedElement();if(!this._hasParent(y,"li")){if(this._hasParent(y,"p")){q=this._getDoc().createElement("p");q.innerHTML="&nbsp;";d.insertAfter(q,y);this._selectNode(q.firstChild)}else{if(this._isElement(y,"body")){this.execCommand("insertparagraph",null);var s=this._getDoc().body.getElementsByTagName("p");for(z=0;z<s.length;z++){if(s[z].getAttribute("_moz_dirty")!==null){q=this._getDoc().createElement("p");q.innerHTML="&nbsp;";d.insertAfter(q,s[z]);this._selectNode(q.firstChild);s[z].removeAttribute("_moz_dirty")}}}else{r=true;w="insertparagraph"}}a.stopEvent(B)}}if(this.browser.webkit){y=this._getSelectedElement();if(!this._hasParent(y,"li")){this.execCommand("insertparagraph",null);var u=this._getDoc().body.getElementsByTagName("div");for(z=0;z<u.length;z++){if(!d.hasClass(u[z],"yui-wk-div")){d.addClass(u[z],"yui-wk-p")}}a.stopEvent(B)}}}else{if(this.browser.webkit){y=this._getSelectedElement();if(!this._hasParent(y,"li")){if(this.browser.webkit4){this.execCommand("insertlinebreak")}else{this.execCommand("inserthtml",'<var id="yui-br"></var>');var o=this._getDoc().getElementById("yui-br"),C=this._getDoc().createElement("br"),m=this._getDoc().createElement("span");o.parentNode.replaceChild(C,o);m.className="yui-non";m.innerHTML="&nbsp;";d.insertAfter(m,C);this._selectNode(m)}a.stopEvent(B)}}if(this.browser.ie){f=this._getRange();y=this._getSelectedElement();if(!this._isElement(y,"li")){if(f){f.pasteHTML("<br>");f.collapse(false);f.select()}a.stopEvent(B)}}}break}if(this.browser.ie){this._listFix(B)}if(r&&w){this.execCommand(w,t);a.stopEvent(B);this.nodeChange()}this._storeUndo();this.fireEvent("editorKeyDown",{type:"editorKeyDown",target:this,ev:B})},_fixListRunning:null,_fixListDupIds:function(){if(this._fixListRunning){return false}if(this._getDoc()){this._fixListRunning=true;var f=this._getDoc().body.getElementsByTagName("li"),g=0,h={};for(g=0;g<f.length;g++){if(f[g].id){if(h[f[g].id]){f[g].id=""}h[f[g].id]=true}}this._fixListRunning=false}},_listFix:function(l){var n=null,j=null,f=false,h=null;if(this.browser.webkit){if(l.keyCode&&(l.keyCode==13)){if(this._hasParent(this._getSelectedElement(),"li")){var i=this._hasParent(this._getSelectedElement(),"li");if(i.previousSibling){if(i.firstChild&&(i.firstChild.length==1)){this._selectNode(i)}}}}}if(l.keyCode&&((!this.browser.webkit3&&(l.keyCode==25))||((this.browser.webkit3||!this.browser.webkit)&&((l.keyCode==9)&&l.shiftKey)))){n=this._getSelectedElement();if(this._hasParent(n,"li")){n=this._hasParent(n,"li");if(this._hasParent(n,"ul")||this._hasParent(n,"ol")){j=this._hasParent(n,"ul");if(!j){j=this._hasParent(n,"ol")}if(this._isElement(j.previousSibling,"li")){j.removeChild(n);j.parentNode.insertBefore(n,j.nextSibling);if(this.browser.ie){h=this._getDoc().body.createTextRange();h.moveToElementText(n);h.collapse(false);h.select()}if(this.browser.webkit){this._selectNode(n.firstChild)}a.stopEvent(l)}}}}if(l.keyCode&&((l.keyCode==9)&&(!l.shiftKey))){var g=this._getSelectedElement();if(this._hasParent(g,"li")){f=this._hasParent(g,"li").innerHTML}if(this.browser.webkit){this._getDoc().execCommand("inserttext",false,"\t")}n=this._getSelectedElement();if(this._hasParent(n,"li")){j=this._hasParent(n,"li");var k=this._getDoc().createElement(j.parentNode.tagName.toLowerCase());if(this.browser.webkit){var m=d.getElementsByClassName("Apple-tab-span","span",j);if(m[0]){j.removeChild(m[0]);j.innerHTML=e.trim(j.innerHTML);if(f){j.innerHTML='<span class="yui-non">'+f+"</span>&nbsp;"}else{j.innerHTML='<span class="yui-non">&nbsp;</span>&nbsp;'}}}else{if(f){j.innerHTML=f+"&nbsp;"}else{j.innerHTML="&nbsp;"}}j.parentNode.replaceChild(k,j);k.appendChild(j);if(this.browser.webkit){this._getSelection().setBaseAndExtent(j.firstChild,1,j.firstChild,j.firstChild.innerText.length);if(!this.browser.webkit3){j.parentNode.parentNode.style.display="list-item";setTimeout(function(){j.parentNode.parentNode.style.display="block"},1)}}else{if(this.browser.ie){h=this._getDoc().body.createTextRange();h.moveToElementText(j);h.collapse(false);h.select()}else{this._selectNode(j)}}a.stopEvent(l)}if(this.browser.webkit){a.stopEvent(l)}this.nodeChange()}},nodeChange:function(f){var g=this;this._storeUndo();if(this.get("nodeChangeDelay")){this._nodeChangeDelayTimer=window.setTimeout(function(){g._nodeChangeDelayTimer=null;g._nodeChange.apply(g,arguments)},0)}else{this._nodeChange()}},_nodeChange:function(g){var k=parseInt(this.get("nodeChangeThreshold"),10),r=Math.round(new Date().getTime()/1000),u=this;if(g===true){this._lastNodeChange=0}if((this._lastNodeChange+k)<r){if(this._fixNodesTimer===null){this._fixNodesTimer=window.setTimeout(function(){u._fixNodes.call(u);u._fixNodesTimer=null},0)}}this._lastNodeChange=r;if(this.currentEvent){try{this._lastNodeChangeEvent=this.currentEvent.type}catch(D){}}var C=this.fireEvent("beforeNodeChange",{type:"beforeNodeChange",target:this});if(C===false){return false}if(this.get("dompath")){window.setTimeout(function(){u._writeDomPath.call(u)},0)}if(!this.get("disabled")){if(this.STOP_NODE_CHANGE){this.STOP_NODE_CHANGE=false;return false}else{var w=this._getSelection(),t=this._getRange(),f=this._getSelectedElement(),p=this.toolbar.getButtonByValue("fontname"),o=this.toolbar.getButtonByValue("fontsize"),m=this.toolbar.getButtonByValue("undo"),h=this.toolbar.getButtonByValue("redo");var q={};if(this._lastButton){q[this._lastButton.id]=true}if(!this._isElement(f,"body")){if(p){q[p.get("id")]=true}if(o){q[o.get("id")]=true}}if(h){delete q[h.get("id")]}this.toolbar.resetAllButtons(q);for(var E=0;E<this._disabled.length;E++){var s=this.toolbar.getButtonByValue(this._disabled[E]);if(s&&s.get){if(this._lastButton&&(s.get("id")===this._lastButton.id)){}else{if(!this._hasSelection()&&!this.get("insert")){switch(this._disabled[E]){case"fontname":case"fontsize":break;default:this.toolbar.disableButton(s)}}else{if(!this._alwaysDisabled[this._disabled[E]]){this.toolbar.enableButton(s)}}if(!this._alwaysEnabled[this._disabled[E]]){this.toolbar.deselectButton(s)}}}}var v=this._getDomPath();var F=null,z=null;for(var A=0;A<v.length;A++){F=v[A].tagName.toLowerCase();if(v[A].getAttribute("tag")){F=v[A].getAttribute("tag").toLowerCase()}z=this._tag2cmd[F];if(z===undefined){z=[]}if(!e.isArray(z)){z=[z]}if(v[A].style.fontWeight.toLowerCase()=="bold"){z[z.length]="bold"}if(v[A].style.fontStyle.toLowerCase()=="italic"){z[z.length]="italic"}if(v[A].style.textDecoration.toLowerCase()=="underline"){z[z.length]="underline"}if(v[A].style.textDecoration.toLowerCase()=="line-through"){z[z.length]="strikethrough"}if(z.length>0){for(var y=0;y<z.length;y++){this.toolbar.selectButton(z[y]);this.toolbar.enableButton(z[y])}}switch(v[A].style.textAlign.toLowerCase()){case"left":case"right":case"center":case"justify":var x=v[A].style.textAlign.toLowerCase();if(v[A].style.textAlign.toLowerCase()=="justify"){x="full"}this.toolbar.selectButton("justify"+x);this.toolbar.enableButton("justify"+x);break}}if(p){var B=p._configs.label._initialConfig.value;p.set("label",'<span class="yui-toolbar-fontname-'+this._cleanClassName(B)+'">'+B+"</span>");this._updateMenuChecked("fontname",B)}if(o){o.set("label",o._configs.label._initialConfig.value)}var n=this.toolbar.getButtonByValue("heading");if(n){n.set("label",n._configs.label._initialConfig.value);this._updateMenuChecked("heading","none")}var l=this.toolbar.getButtonByValue("insertimage");if(l&&this.currentWindow&&(this.currentWindow.name=="insertimage")){this.toolbar.disableButton(l)}if(this._lastButton&&this._lastButton.isSelected){this.toolbar.deselectButton(this._lastButton.id)}this._undoNodeChange()}}this.fireEvent("afterNodeChange",{type:"afterNodeChange",target:this})},_updateMenuChecked:function(f,g,i){if(!i){i=this.toolbar}var h=i.getButtonByValue(f);h.checkValue(g)},_handleToolbarClick:function(g){var i="";var j="";var h=g.button.value;if(g.button.menucmd){i=h;h=g.button.menucmd}this._lastButton=g.button;if(this.STOP_EXEC_COMMAND){this.STOP_EXEC_COMMAND=false;return false}else{this.execCommand(h,i);if(!this.browser.webkit){var f=this;setTimeout(function(){f.focus.call(f)},5)}}a.stopEvent(g)},_setupAfterElement:function(){if(!this.beforeElement){this.beforeElement=document.createElement("h2");this.beforeElement.className="yui-editor-skipheader";this.beforeElement.tabIndex="-1";this.beforeElement.innerHTML=this.STR_BEFORE_EDITOR;this.get("element_cont").get("firstChild").insertBefore(this.beforeElement,this.toolbar.get("nextSibling"))}if(!this.afterElement){this.afterElement=document.createElement("h2");this.afterElement.className="yui-editor-skipheader";this.afterElement.tabIndex="-1";this.afterElement.innerHTML=this.STR_LEAVE_EDITOR;this.get("element_cont").get("firstChild").appendChild(this.afterElement)}},_disableEditor:function(k){var j,i,h,f;if(!this.get("disabled_iframe")){j=this._createIframe();j.set("id","disabled_"+this.get("iframe").get("id"));j.setStyle("height","100%");j.setStyle("display","none");j.setStyle("visibility","visible");this.set("disabled_iframe",j);i=this.get("iframe").get("parentNode");i.appendChild(j.get("element"))}if(!j){j=this.get("disabled_iframe")}if(k){this._orgIframe=this.get("iframe");if(this.toolbar){this.toolbar.set("disabled",true)}h=this.getEditorHTML();f=this.get("iframe").get("offsetHeight");j.setStyle("visibility","");j.setStyle("position","");j.setStyle("top","");j.setStyle("left","");this._orgIframe.setStyle("visibility","hidden");this._orgIframe.setStyle("position","absolute");this._orgIframe.setStyle("top","-99999px");this._orgIframe.setStyle("left","-99999px");this.set("iframe",j);this._setInitialContent(true);if(!this._mask){this._mask=document.createElement("DIV");d.addClass(this._mask,"yui-editor-masked");if(this.browser.ie){this._mask.style.height=f+"px"}this.get("iframe").get("parentNode").appendChild(this._mask)}this.on("editorContentReloaded",function(){this._getDoc().body._rteLoaded=false;this.setEditorHTML(h);j.setStyle("display","block");this.unsubscribeAll("editorContentReloaded")})}else{if(this._mask){this._mask.parentNode.removeChild(this._mask);this._mask=null;if(this.toolbar){this.toolbar.set("disabled",false)}j.setStyle("visibility","hidden");j.setStyle("position","absolute");j.setStyle("top","-99999px");j.setStyle("left","-99999px");this._orgIframe.setStyle("visibility","");this._orgIframe.setStyle("position","");this._orgIframe.setStyle("top","");this._orgIframe.setStyle("left","");this.set("iframe",this._orgIframe);this.focus();var g=this;window.setTimeout(function(){g.nodeChange.call(g)},100)}}},SEP_DOMPATH:"<",STR_LEAVE_EDITOR:"You have left the Rich Text Editor.",STR_BEFORE_EDITOR:"This text field can contain stylized text and graphics. To cycle through all formatting options, use the keyboard shortcut Shift + Escape to place focus on the toolbar and navigate between options with your arrow keys. To exit this text editor use the Escape key and continue tabbing. <h4>Common formatting keyboard shortcuts:</h4><ul><li>Control Shift B sets text to bold</li> <li>Control Shift I sets text to italic</li> <li>Control Shift U underlines text</li> <li>Control Shift L adds an HTML link</li></ul>",STR_TITLE:"Rich Text Area.",STR_IMAGE_HERE:"Image URL Here",STR_IMAGE_URL:"Image URL",STR_LINK_URL:"Link URL",STOP_EXEC_COMMAND:false,STOP_NODE_CHANGE:false,CLASS_NOEDIT:"yui-noedit",CLASS_CONTAINER:"yui-editor-container",CLASS_EDITABLE:"yui-editor-editable",CLASS_EDITABLE_CONT:"yui-editor-editable-container",CLASS_PREFIX:"yui-editor",browser:function(){var f=YAHOO.env.ua;if(f.webkit>=420){f.webkit3=f.webkit}else{f.webkit3=0}if(f.webkit>=530){f.webkit4=f.webkit}else{f.webkit4=0}f.mac=false;if(navigator.userAgent.indexOf("Macintosh")!==-1){f.mac=true}return f}(),init:function(g,f){if(!this._defaultToolbar){this._defaultToolbar={collapse:true,titlebar:"Text Editing Tools",draggable:false,buttons:[{group:"fontstyle",label:"Font Name and Size",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:true,menu:[{text:"Arial",checked:true},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:true}]},{type:"separator"},{group:"textstyle",label:"Font Style",buttons:[{type:"push",label:"Bold CTRL + SHIFT + B",value:"bold"},{type:"push",label:"Italic CTRL + SHIFT + I",value:"italic"},{type:"push",label:"Underline CTRL + SHIFT + U",value:"underline"},{type:"push",label:"Strike Through",value:"strikethrough"},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:true},{type:"color",label:"Background Color",value:"backcolor",disabled:true}]},{type:"separator"},{group:"indentlist",label:"Lists",buttons:[{type:"push",label:"Create an Unordered List",value:"insertunorderedlist"},{type:"push",label:"Create an Ordered List",value:"insertorderedlist"}]},{type:"separator"},{group:"insertitem",label:"Insert Item",buttons:[{type:"push",label:"HTML Link CTRL + SHIFT + L",value:"createlink",disabled:true},{type:"push",label:"Insert Image",value:"insertimage"}]}]}}YAHOO.widget.SimpleEditor.superclass.init.call(this,g,f);YAHOO.widget.EditorInfo._instances[this.get("id")]=this;this.currentElement=[];this.on("contentReady",function(){this.DOMReady=true;this.fireQueue()},this,true)},initAttributes:function(f){YAHOO.widget.SimpleEditor.superclass.initAttributes.call(this,f);var g=this;this.setAttributeConfig("setDesignMode",{value:((f.setDesignMode===false)?false:true)});this.setAttributeConfig("nodeChangeDelay",{value:((f.nodeChangeDelay===false)?false:true)});this.setAttributeConfig("maxUndo",{writeOnce:true,value:f.maxUndo||30});this.setAttributeConfig("ptags",{writeOnce:true,value:f.ptags||false});this.setAttributeConfig("insert",{writeOnce:true,value:f.insert||false,method:function(m){if(m){var l={fontname:true,fontsize:true,forecolor:true,backcolor:true};var k=this._defaultToolbar.buttons;for(var j=0;j<k.length;j++){if(k[j].buttons){for(var h=0;h<k[j].buttons.length;h++){if(k[j].buttons[h].value){if(l[k[j].buttons[h].value]){delete k[j].buttons[h].disabled}}}}}}}});this.setAttributeConfig("container",{writeOnce:true,value:f.container||false});this.setAttributeConfig("plainText",{writeOnce:true,value:f.plainText||false});this.setAttributeConfig("iframe",{value:null});this.setAttributeConfig("disabled_iframe",{value:null});this.setAttributeConfig("textarea",{value:null,writeOnce:true});this.setAttributeConfig("nodeChangeThreshold",{value:f.nodeChangeThreshold||3,validator:YAHOO.lang.isNumber});this.setAttributeConfig("allowNoEdit",{value:f.allowNoEdit||false,validator:YAHOO.lang.isBoolean});this.setAttributeConfig("limitCommands",{value:f.limitCommands||false,validator:YAHOO.lang.isBoolean});this.setAttributeConfig("element_cont",{value:f.element_cont});this.setAttributeConfig("editor_wrapper",{value:f.editor_wrapper||null,writeOnce:true});this.setAttributeConfig("height",{value:f.height||d.getStyle(g.get("element"),"height"),method:function(h){if(this._rendered){if(this.get("animate")){var i=new YAHOO.util.Anim(this.get("iframe").get("parentNode"),{height:{to:parseInt(h,10)}},0.5);i.animate()}else{d.setStyle(this.get("iframe").get("parentNode"),"height",h)}}}});this.setAttributeConfig("autoHeight",{value:f.autoHeight||false,method:function(h){if(h){if(this.get("iframe")){this.get("iframe").get("element").setAttribute("scrolling","no")}this.on("afterNodeChange",this._handleAutoHeight,this,true);this.on("editorKeyDown",this._handleAutoHeight,this,true);this.on("editorKeyPress",this._handleAutoHeight,this,true)}else{if(this.get("iframe")){this.get("iframe").get("element").setAttribute("scrolling","auto")}this.unsubscribe("afterNodeChange",this._handleAutoHeight);this.unsubscribe("editorKeyDown",this._handleAutoHeight);this.unsubscribe("editorKeyPress",this._handleAutoHeight)}}});this.setAttributeConfig("width",{value:f.width||d.getStyle(this.get("element"),"width"),method:function(h){if(this._rendered){if(this.get("animate")){var i=new YAHOO.util.Anim(this.get("element_cont").get("element"),{width:{to:parseInt(h,10)}},0.5);i.animate()}else{this.get("element_cont").setStyle("width",h)}}}});this.setAttributeConfig("blankimage",{value:f.blankimage||this._getBlankImage()});this.setAttributeConfig("css",{value:f.css||this._defaultCSS,writeOnce:true});this.setAttributeConfig("html",{value:f.html||'<html><head><title>{TITLE}</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><base href="'+this._baseHREF+'"><style>{CSS}</style><style>{HIDDEN_CSS}</style><style>{EXTRA_CSS}</style></head><body onload="document.body._rteLoaded = true;">{CONTENT}</body></html>',writeOnce:true});this.setAttributeConfig("extracss",{value:f.extracss||"",writeOnce:true});this.setAttributeConfig("handleSubmit",{value:f.handleSubmit||false,method:function(h){if(this.get("element").form){if(!this._formButtons){this._formButtons=[]}if(h){a.on(this.get("element").form,"submit",this._handleFormSubmit,this,true);var j=this.get("element").form.getElementsByTagName("input");for(var l=0;l<j.length;l++){var k=j[l].getAttribute("type");if(k&&(k.toLowerCase()=="submit")){a.on(j[l],"click",this._handleFormButtonClick,this,true);this._formButtons[this._formButtons.length]=j[l]}}}else{a.removeListener(this.get("element").form,"submit",this._handleFormSubmit);if(this._formButtons){a.removeListener(this._formButtons,"click",this._handleFormButtonClick)}}}}});this.setAttributeConfig("disabled",{value:false,method:function(h){if(this._rendered){this._disableEditor(h)}}});this.setAttributeConfig("saveEl",{value:this.get("element")});this.setAttributeConfig("toolbar_cont",{value:null,writeOnce:true});this.setAttributeConfig("toolbar",{value:f.toolbar||this._defaultToolbar,writeOnce:true,method:function(h){if(!h.buttonType){h.buttonType=this._defaultToolbar.buttonType}this._defaultToolbar=h}});this.setAttributeConfig("animate",{value:((f.animate)?((YAHOO.util.Anim)?true:false):false),validator:function(i){var h=true;if(!YAHOO.util.Anim){h=false}return h}});this.setAttributeConfig("panel",{value:null,writeOnce:true,validator:function(i){var h=true;if(!YAHOO.widget.Overlay){h=false}return h}});this.setAttributeConfig("focusAtStart",{value:f.focusAtStart||false,writeOnce:true,method:function(h){if(h){this.on("editorContentLoaded",function(){var i=this;setTimeout(function(){i.focus.call(i);i.editorDirty=false},400)},this,true)}}});this.setAttributeConfig("dompath",{value:f.dompath||false,method:function(h){if(h&&!this.dompath){this.dompath=document.createElement("DIV");this.dompath.id=this.get("id")+"_dompath";d.addClass(this.dompath,"dompath");this.get("element_cont").get("firstChild").appendChild(this.dompath);if(this.get("iframe")){this._writeDomPath()}}else{if(!h&&this.dompath){this.dompath.parentNode.removeChild(this.dompath);this.dompath=null}}}});this.setAttributeConfig("markup",{value:f.markup||"semantic",validator:function(h){switch(h.toLowerCase()){case"semantic":case"css":case"default":case"xhtml":return true}return false}});this.setAttributeConfig("removeLineBreaks",{value:f.removeLineBreaks||false,validator:YAHOO.lang.isBoolean});this.setAttributeConfig("drag",{writeOnce:true,value:f.drag||false});this.setAttributeConfig("resize",{writeOnce:true,value:f.resize||false});this.setAttributeConfig("filterWord",{value:f.filterWord||false,validator:YAHOO.lang.isBoolean})},_getBlankImage:function(){if(!this.DOMReady){this._queue[this._queue.length]=["_getBlankImage",arguments];return""}var f="";if(!this._blankImageLoaded){if(YAHOO.widget.EditorInfo.blankImage){this.set("blankimage",YAHOO.widget.EditorInfo.blankImage);this._blankImageLoaded=true}else{var g=document.createElement("div");g.style.position="absolute";g.style.top="-9999px";g.style.left="-9999px";g.className=this.CLASS_PREFIX+"-blankimage";document.body.appendChild(g);f=YAHOO.util.Dom.getStyle(g,"background-image");f=f.replace("url(","").replace(")","").replace(/"/g,"");f=f.replace("app:/","");this.set("blankimage",f);this._blankImageLoaded=true;g.parentNode.removeChild(g);YAHOO.widget.EditorInfo.blankImage=f}}else{f=this.get("blankimage")}return f},_handleAutoHeight:function(){var k=this._getDoc(),g=k.body,l=k.documentElement;var f=parseInt(d.getStyle(this.get("editor_wrapper"),"height"),10);var h=g.scrollHeight;if(this.browser.webkit){h=l.scrollHeight}if(h<parseInt(this.get("height"),10)){h=parseInt(this.get("height"),10)}if((f!=h)&&(h>=parseInt(this.get("height"),10))){var j=this.get("animate");this.set("animate",false);this.set("height",h+"px");this.set("animate",j);if(this.browser.ie){this.get("iframe").setStyle("height","99%");this.get("iframe").setStyle("zoom","1");var i=this;window.setTimeout(function(){i.get("iframe").setStyle("height","100%")},1)}}},_formButtons:null,_formButtonClicked:null,_handleFormButtonClick:function(g){var f=a.getTarget(g);this._formButtonClicked=f},_handleFormSubmit:function(i){this.saveHTML();var h=this.get("element").form,f=this._formButtonClicked||false;a.removeListener(h,"submit",this._handleFormSubmit);if(YAHOO.env.ua.ie){if(f&&!f.disabled){f.click()}}else{if(f&&!f.disabled){f.click()}var g=document.createEvent("HTMLEvents");g.initEvent("submit",true,true);h.dispatchEvent(g);if(YAHOO.env.ua.webkit){if(YAHOO.lang.isFunction(h.submit)){h.submit()}}}},_handleFontSize:function(h){var f=this.toolbar.getButtonById(h.button.id);var g=f.get("label")+"px";this.execCommand("fontsize",g);return false},_handleColorPicker:function(h){var g=h.button;var f="#"+h.color;if((g=="forecolor")||(g=="backcolor")){this.execCommand(g,f)}},_handleAlign:function(j){var h=null;for(var f=0;f<j.button.menu.length;f++){if(j.button.menu[f].value==j.button.value){h=j.button.menu[f].value}}var g=this._getSelection();this.execCommand(h,g);return false},_handleAfterNodeChange:function(){var t=this._getDomPath(),o=null,k=null,p=null,g=false,m=this.toolbar.getButtonByValue("fontname"),n=this.toolbar.getButtonByValue("fontsize"),f=this.toolbar.getButtonByValue("heading");for(var j=0;j<t.length;j++){o=t[j];var s=o.tagName.toLowerCase();if(o.getAttribute("tag")){s=o.getAttribute("tag")}k=o.getAttribute("face");if(d.getStyle(o,"font-family")){k=d.getStyle(o,"font-family");k=k.replace(/'/g,"")}if(s.substring(0,1)=="h"){if(f){for(var l=0;l<f._configs.menu.value.length;l++){if(f._configs.menu.value[l].value.toLowerCase()==s){f.set("label",f._configs.menu.value[l].text)}}this._updateMenuChecked("heading",s)}}}if(m){for(var r=0;r<m._configs.menu.value.length;r++){if(k&&m._configs.menu.value[r].text.toLowerCase()==k.toLowerCase()){g=true;k=m._configs.menu.value[r].text}}if(!g){k=m._configs.label._initialConfig.value}var q='<span class="yui-toolbar-fontname-'+this._cleanClassName(k)+'">'+k+"</span>";if(m.get("label")!=q){m.set("label",q);this._updateMenuChecked("fontname",k)}}if(n){p=parseInt(d.getStyle(o,"fontSize"),10);if((p===null)||isNaN(p)){p=n._configs.label._initialConfig.value}n.set("label",""+p)}if(!this._isElement(o,"body")&&!this._isElement(o,"img")){this.toolbar.enableButton(m);this.toolbar.enableButton(n);this.toolbar.enableButton("forecolor");this.toolbar.enableButton("backcolor")}if(this._isElement(o,"img")){if(YAHOO.widget.Overlay){this.toolbar.enableButton("createlink")}}if(this._hasParent(o,"blockquote")){this.toolbar.selectButton("indent");this.toolbar.disableButton("indent");this.toolbar.enableButton("outdent")}if(this._hasParent(o,"ol")||this._hasParent(o,"ul")){this.toolbar.disableButton("indent")}this._lastButton=null},_handleInsertImageClick:function(){if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("insertimage")){return false}}this.toolbar.set("disabled",true);var f=function(){var g=this.currentElement[0],i="http://";if(!g){g=this._getSelectedElement()}if(g){if(g.getAttribute("src")){i=g.getAttribute("src",2);if(i.indexOf(this.get("blankimage"))!=-1){i=this.STR_IMAGE_HERE}}}var h=prompt(this.STR_IMAGE_URL+": ",i);if((h!=="")&&(h!==null)){g.setAttribute("src",h)}else{if(h===""){g.parentNode.removeChild(g);this.currentElement=[];this.nodeChange()}else{if((h===null)){i=g.getAttribute("src",2);if(i.indexOf(this.get("blankimage"))!=-1){g.parentNode.removeChild(g);this.currentElement=[];this.nodeChange()}}}}this.closeWindow();this.toolbar.set("disabled",false);this.unsubscribe("afterExecCommand",f,this,true)};this.on("afterExecCommand",f,this,true)},_handleInsertImageWindowClose:function(){this.nodeChange()},_isLocalFile:function(f){if((f)&&(f!=="")&&((f.indexOf("file:/")!=-1)||(f.indexOf(":\\")!=-1))){return true}return false},_handleCreateLinkClick:function(){if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue("createlink")){return false}}this.toolbar.set("disabled",true);var f=function(){var i=this.currentElement[0],h="";if(i){if(i.getAttribute("href",2)!==null){h=i.getAttribute("href",2)}}var k=prompt(this.STR_LINK_URL+": ",h);if((k!=="")&&(k!==null)){var j=k;if((j.indexOf("://")==-1)&&(j.substring(0,1)!="/")&&(j.substring(0,6).toLowerCase()!="mailto")){if((j.indexOf("@")!=-1)&&(j.substring(0,6).toLowerCase()!="mailto")){j="mailto:"+j}else{if(j.substring(0,1)!="#"){}}}i.setAttribute("href",j)}else{if(k!==null){var g=this._getDoc().createElement("span");g.innerHTML=i.innerHTML;d.addClass(g,"yui-non");i.parentNode.replaceChild(g,i)}}this.closeWindow();this.toolbar.set("disabled",false);this.unsubscribe("afterExecCommand",f,this,true)};this.on("afterExecCommand",f,this)},_handleCreateLinkWindowClose:function(){this.nodeChange();this.currentElement=[]},render:function(){if(this._rendered){return false}if(!this.DOMReady){this._queue[this._queue.length]=["render",arguments];return false}if(this.get("element")){if(this.get("element").tagName){this._textarea=true;if(this.get("element").tagName.toLowerCase()!=="textarea"){this._textarea=false}}else{return false}}else{return false}this._rendered=true;var f=this;window.setTimeout(function(){f._render.call(f)},4)},_render:function(){var f=this;this.set("textarea",this.get("element"));this.get("element_cont").setStyle("display","none");this.get("element_cont").addClass(this.CLASS_CONTAINER);this.set("iframe",this._createIframe());window.setTimeout(function(){f._setInitialContent.call(f)},10);this.get("editor_wrapper").appendChild(this.get("iframe").get("element"));if(this.get("disabled")){this._disableEditor(true)}var g=this.get("toolbar");if(g instanceof c){this.toolbar=g;this.toolbar.set("disabled",true)}else{g.disabled=true;this.toolbar=new c(this.get("toolbar_cont"),g)}this.fireEvent("toolbarLoaded",{type:"toolbarLoaded",target:this.toolbar});this.toolbar.on("toolbarCollapsed",function(){if(this.currentWindow){this.moveWindow()}},this,true);this.toolbar.on("toolbarExpanded",function(){if(this.currentWindow){this.moveWindow()}},this,true);this.toolbar.on("fontsizeClick",this._handleFontSize,this,true);this.toolbar.on("colorPickerClicked",function(h){this._handleColorPicker(h);return false},this,true);this.toolbar.on("alignClick",this._handleAlign,this,true);this.on("afterNodeChange",this._handleAfterNodeChange,this,true);this.toolbar.on("insertimageClick",this._handleInsertImageClick,this,true);this.on("windowinsertimageClose",this._handleInsertImageWindowClose,this,true);this.toolbar.on("createlinkClick",this._handleCreateLinkClick,this,true);this.on("windowcreatelinkClose",this._handleCreateLinkWindowClose,this,true);this.get("parentNode").replaceChild(this.get("element_cont").get("element"),this.get("element"));this.setStyle("visibility","hidden");this.setStyle("position","absolute");this.setStyle("top","-9999px");this.setStyle("left","-9999px");this.get("element_cont").appendChild(this.get("element"));this.get("element_cont").setStyle("display","block");d.addClass(this.get("iframe").get("parentNode"),this.CLASS_EDITABLE_CONT);this.get("iframe").addClass(this.CLASS_EDITABLE);this.get("element_cont").setStyle("width",this.get("width"));d.setStyle(this.get("iframe").get("parentNode"),"height",this.get("height"));this.get("iframe").setStyle("width","100%");this.get("iframe").setStyle("height","100%");this._setupDD();window.setTimeout(function(){f._setupAfterElement.call(f)},0);this.fireEvent("afterRender",{type:"afterRender",target:this})},execCommand:function(h,g){var k=this.fireEvent("beforeExecCommand",{type:"beforeExecCommand",target:this,args:arguments});if((k===false)||(this.STOP_EXEC_COMMAND)){this.STOP_EXEC_COMMAND=false;return false}this._lastCommand=h;this._setMarkupType(h);if(this.browser.ie){this._getWindow().focus()}var f=true;if(this.get("limitCommands")){if(!this.toolbar.getButtonByValue(h)){f=false}}this.editorDirty=true;if((typeof this["cmd_"+h.toLowerCase()]=="function")&&f){var j=this["cmd_"+h.toLowerCase()](g);f=j[0];if(j[1]){h=j[1]}if(j[2]){g=j[2]}}if(f){try{this._getDoc().execCommand(h,false,g)}catch(i){}}else{}this.on("afterExecCommand",function(){this.unsubscribeAll("afterExecCommand");this.nodeChange()},this,true);this.fireEvent("afterExecCommand",{type:"afterExecCommand",target:this})},cmd_bold:function(i){if(!this.browser.webkit){var h=this._getSelectedElement();if(h&&this._isElement(h,"span")&&this._hasSelection()){if(h.style.fontWeight=="bold"){h.style.fontWeight="";var f=this._getDoc().createElement("b"),g=h.parentNode;g.replaceChild(f,h);f.appendChild(h)}}}return[true]},cmd_italic:function(j){if(!this.browser.webkit){var h=this._getSelectedElement();if(h&&this._isElement(h,"span")&&this._hasSelection()){if(h.style.fontStyle=="italic"){h.style.fontStyle="";var f=this._getDoc().createElement("i"),g=h.parentNode;g.replaceChild(f,h);f.appendChild(h)}}}return[true]},cmd_underline:function(g){if(!this.browser.webkit){var f=this._getSelectedElement();if(f&&this._isElement(f,"span")){if(f.style.textDecoration=="underline"){f.style.textDecoration="none"}else{f.style.textDecoration="underline"}return[false]}}return[true]},cmd_backcolor:function(i){var f=true,g=this._getSelectedElement(),h="backcolor";if(this.browser.gecko||this.browser.opera){this._setEditorStyle(true);h="hilitecolor"}if(!this._isElement(g,"body")&&!this._hasSelection()){g.style.backgroundColor=i;this._selectNode(g);f=false}else{if(this.get("insert")){g=this._createInsertElement({backgroundColor:i})}else{this._createCurrentElement("span",{backgroundColor:i,color:g.style.color,fontSize:g.style.fontSize,fontFamily:g.style.fontFamily});this._selectNode(this.currentElement[0])}f=false}return[f,h]},cmd_forecolor:function(h){var f=true,g=this._getSelectedElement();if(!this._isElement(g,"body")&&!this._hasSelection()){d.setStyle(g,"color",h);this._selectNode(g);f=false}else{if(this.get("insert")){g=this._createInsertElement({color:h})}else{this._createCurrentElement("span",{color:h,fontSize:g.style.fontSize,fontFamily:g.style.fontFamily,backgroundColor:g.style.backgroundColor});this._selectNode(this.currentElement[0])}f=false}return[f]},cmd_unlink:function(f){this._swapEl(this.currentElement[0],"span",function(g){g.className="yui-non"});return[false]},cmd_createlink:function(h){var g=this._getSelectedElement(),f=null;if(this._hasParent(g,"a")){this.currentElement[0]=this._hasParent(g,"a")}else{if(this._isElement(g,"li")){f=this._getDoc().createElement("a");f.innerHTML=g.innerHTML;g.innerHTML="";g.appendChild(f);this.currentElement[0]=f}else{if(!this._isElement(g,"a")){this._createCurrentElement("a");f=this._swapEl(this.currentElement[0],"a");this.currentElement[0]=f}else{this.currentElement[0]=g}}}return[false]},cmd_insertimage:function(l){var f=true,g=null,k="insertimage",j=this._getSelectedElement();if(l===""){l=this.get("blankimage")}if(this._isElement(j,"img")){this.currentElement[0]=j;f=false}else{if(this._getDoc().queryCommandEnabled(k)){this._getDoc().execCommand(k,false,l);var m=this._getDoc().getElementsByTagName("img");for(var h=0;h<m.length;h++){if(!YAHOO.util.Dom.hasClass(m[h],"yui-img")){YAHOO.util.Dom.addClass(m[h],"yui-img");this.currentElement[0]=m[h]}}f=false}else{if(j==this._getDoc().body){g=this._getDoc().createElement("img");g.setAttribute("src",l);YAHOO.util.Dom.addClass(g,"yui-img");this._getDoc().body.appendChild(g)}else{this._createCurrentElement("img");g=this._getDoc().createElement("img");g.setAttribute("src",l);YAHOO.util.Dom.addClass(g,"yui-img");this.currentElement[0].parentNode.replaceChild(g,this.currentElement[0])}this.currentElement[0]=g;f=false}}return[f]},cmd_inserthtml:function(i){var f=true,h="inserthtml",g=null,j=null;if(this.browser.webkit&&!this._getDoc().queryCommandEnabled(h)){this._createCurrentElement("img");g=this._getDoc().createElement("span");g.innerHTML=i;this.currentElement[0].parentNode.replaceChild(g,this.currentElement[0]);f=false}else{if(this.browser.ie){j=this._getRange();if(j.item){j.item(0).outerHTML=i}else{j.pasteHTML(i)}f=false}}return[f]},cmd_list:function(H){var z=true,D=null,q=0,h=null,y="",G=this._getSelectedElement(),A="insertorderedlist";if(H=="ul"){A="insertunorderedlist"}if((this.browser.webkit&&!this.browser.webkit4)||(this.browser.opera)){if(this._isElement(G,"li")&&this._isElement(G.parentNode,H)){h=G.parentNode;D=this._getDoc().createElement("span");YAHOO.util.Dom.addClass(D,"yui-non");y="";var g=h.getElementsByTagName("li"),l=((this.browser.opera&&this.get("ptags"))?"p":"div");for(q=0;q<g.length;q++){y+="<"+l+">"+g[q].innerHTML+"</"+l+">"}D.innerHTML=y;this.currentElement[0]=h;this.currentElement[0].parentNode.replaceChild(D,this.currentElement[0])}else{this._createCurrentElement(H.toLowerCase());D=this._getDoc().createElement(H);for(q=0;q<this.currentElement.length;q++){var n=this._getDoc().createElement("li");n.innerHTML=this.currentElement[q].innerHTML+'<span class="yui-non">&nbsp;</span>&nbsp;';D.appendChild(n);if(q>0){this.currentElement[q].parentNode.removeChild(this.currentElement[q])}}var x=((this.browser.opera)?"<BR>":"<br>"),w=D.firstChild.innerHTML.split(x),C,E;if(w.length>0){D.innerHTML="";for(C=0;C<w.length;C++){E=this._getDoc().createElement("li");E.innerHTML=w[C];D.appendChild(E)}}this.currentElement[0].parentNode.replaceChild(D,this.currentElement[0]);this.currentElement[0]=D;var k=this.currentElement[0].firstChild;k=d.getElementsByClassName("yui-non","span",k)[0];if(this.browser.webkit){this._getSelection().setBaseAndExtent(k,1,k,k.innerText.length)}}z=false}else{h=this._getSelectedElement();if(this._isElement(h,"li")&&this._isElement(h.parentNode,H)||(this.browser.ie&&this._isElement(this._getRange().parentElement,"li"))||(this.browser.ie&&this._isElement(h,"ul"))||(this.browser.ie&&this._isElement(h,"ol"))){if(this.browser.ie){if((this.browser.ie&&this._isElement(h,"ul"))||(this.browser.ie&&this._isElement(h,"ol"))){h=h.getElementsByTagName("li")[0]}y="";var m=h.parentNode.getElementsByTagName("li");for(var B=0;B<m.length;B++){y+=m[B].innerHTML+"<br>"}var F=this._getDoc().createElement("span");F.innerHTML=y;h.parentNode.parentNode.replaceChild(F,h.parentNode)}else{this.nodeChange();this._getDoc().execCommand(A,"",h.parentNode);this.nodeChange()}z=false}if(this.browser.opera){var v=this;window.setTimeout(function(){var j=v._getDoc().getElementsByTagName("li");for(var t=0;t<j.length;t++){if(j[t].innerHTML.toLowerCase()=="<br>"){j[t].parentNode.parentNode.removeChild(j[t].parentNode)}}},30)}if(this.browser.ie&&z){var o="";if(this._getRange().html){o="<li>"+this._getRange().html+"</li>"}else{var p=this._getRange().text.split("\n");if(p.length>1){o="";for(var u=0;u<p.length;u++){o+="<li>"+p[u]+"</li>"}}else{var s=this._getRange().text;if(s===""){o='<li id="new_list_item">'+s+"</li>"}else{o="<li>"+s+"</li>"}}}this._getRange().pasteHTML("<"+H+">"+o+"</"+H+">");var f=this._getDoc().getElementById("new_list_item");if(f){var r=this._getDoc().body.createTextRange();r.moveToElementText(f);r.collapse(false);r.select();f.id=""}z=false}}return z},cmd_insertorderedlist:function(f){return[this.cmd_list("ol")]},cmd_insertunorderedlist:function(f){return[this.cmd_list("ul")]},cmd_fontname:function(i){var f=true,h=this._getSelectedElement();this.currentFont=i;if(h&&h.tagName&&!this._hasSelection()&&!this._isElement(h,"body")&&!this.get("insert")){YAHOO.util.Dom.setStyle(h,"font-family",i);f=false}else{if(this.get("insert")&&!this._hasSelection()){var g=this._createInsertElement({fontFamily:i});f=false}}return[f]},cmd_fontsize:function(i){var f=null,h=true;f=this._getSelectedElement();if(this.browser.webkit){if(this.currentElement[0]){if(f==this.currentElement[0]){h=false;YAHOO.util.Dom.setStyle(f,"fontSize",i);this._selectNode(f);this.currentElement[0]=f}}}if(h){if(!this._isElement(this._getSelectedElement(),"body")&&(!this._hasSelection())){f=this._getSelectedElement();YAHOO.util.Dom.setStyle(f,"fontSize",i);if(this.get("insert")&&this.browser.ie){var g=this._getRange();g.collapse(false);g.select()}else{this._selectNode(f)}}else{if(this.currentElement&&(this.currentElement.length>0)&&(!this._hasSelection())&&(!this.get("insert"))){YAHOO.util.Dom.setStyle(this.currentElement,"fontSize",i)}else{if(this.get("insert")&&!this._hasSelection()){f=this._createInsertElement({fontSize:i});this.currentElement[0]=f;this._selectNode(this.currentElement[0])}else{this._createCurrentElement("span",{fontSize:i,fontFamily:f.style.fontFamily,color:f.style.color,backgroundColor:f.style.backgroundColor});this._selectNode(this.currentElement[0])}}}}return[false]},_swapEl:function(g,f,i){var h=this._getDoc().createElement(f);if(g){h.innerHTML=g.innerHTML}if(typeof i=="function"){i.call(this,h)}if(g){g.parentNode.replaceChild(h,g)}return h},_createInsertElement:function(f){this._createCurrentElement("span",f);var g=this.currentElement[0];if(this.browser.webkit){g.innerHTML='<span class="yui-non">&nbsp;</span>';g=g.firstChild;this._getSelection().setBaseAndExtent(g,1,g,g.innerText.length)}else{if(this.browser.ie||this.browser.opera){g.innerHTML="&nbsp;"}}this.focus();this._selectNode(g,true);return g},_createCurrentElement:function(h,m){h=((h)?h:"a");var v=null,g=[],k=this._getDoc();if(this.currentFont){if(!m){m={}}m.fontFamily=this.currentFont;this.currentFont=null}this.currentElement=[];var q=function(j,A){var o=null;j=((j)?j:"span");j=j.toLowerCase();switch(j){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":o=k.createElement(j);break;default:o=k.createElement(j);if(j==="span"){YAHOO.util.Dom.addClass(o,"yui-tag-"+j);YAHOO.util.Dom.addClass(o,"yui-tag");o.setAttribute("tag",j)}for(var i in A){if(YAHOO.lang.hasOwnProperty(A,i)){o.style[i]=A[i]}}break}return o};if(!this._hasSelection()){if(this._getDoc().queryCommandEnabled("insertimage")){this._getDoc().execCommand("insertimage",false,"yui-tmp-img");var p=this._getDoc().getElementsByTagName("img");for(var u=0;u<p.length;u++){if(p[u].getAttribute("src",2)=="yui-tmp-img"){g=q(h,m);p[u].parentNode.replaceChild(g,p[u]);this.currentElement[this.currentElement.length]=g}}}else{if(this.currentEvent){v=YAHOO.util.Event.getTarget(this.currentEvent)}else{v=this._getDoc().body}}if(v){g=q(h,m);if(this._isElement(v,"body")||this._isElement(v,"html")){if(this._isElement(v,"html")){v=this._getDoc().body}v.appendChild(g)}else{if(v.nextSibling){v.parentNode.insertBefore(g,v.nextSibling)}else{v.parentNode.appendChild(g)}}this.currentElement[this.currentElement.length]=g;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(g,0,g,0);if(this.browser.webkit3){this._getSelection().collapseToStart()}else{this._getSelection().collapse(true)}}}}else{this._setEditorStyle(true);this._getDoc().execCommand("fontname",false,"yui-tmp");var f=[],t,z=["font","span","i","b","u"];if(!this._isElement(this._getSelectedElement(),"body")){z[z.length]=this._getDoc().getElementsByTagName(this._getSelectedElement().tagName);z[z.length]=this._getDoc().getElementsByTagName(this._getSelectedElement().parentNode.tagName)}for(var n=0;n<z.length;n++){var l=this._getDoc().getElementsByTagName(z[n]);for(var y=0;y<l.length;y++){f[f.length]=l[y]}}for(var w=0;w<f.length;w++){if((YAHOO.util.Dom.getStyle(f[w],"font-family")=="yui-tmp")||(f[w].face&&(f[w].face=="yui-tmp"))){if(h!=="span"){g=q(h,m)}else{g=q(f[w].tagName,m)}g.innerHTML=f[w].innerHTML;if(this._isElement(f[w],"ol")||(this._isElement(f[w],"ul"))){var r=f[w].getElementsByTagName("li")[0];f[w].style.fontFamily="inherit";r.style.fontFamily="inherit";g.innerHTML=r.innerHTML;r.innerHTML="";r.appendChild(g);this.currentElement[this.currentElement.length]=g}else{if(this._isElement(f[w],"li")){f[w].innerHTML="";f[w].appendChild(g);f[w].style.fontFamily="inherit";this.currentElement[this.currentElement.length]=g}else{if(f[w].parentNode){f[w].parentNode.replaceChild(g,f[w]);this.currentElement[this.currentElement.length]=g;this.currentEvent=null;if(this.browser.webkit){this._getSelection().setBaseAndExtent(g,0,g,0);if(this.browser.webkit3){this._getSelection().collapseToStart()}else{this._getSelection().collapse(true)}}if(this.browser.ie&&m&&m.fontSize){this._getSelection().empty()}if(this.browser.gecko){this._getSelection().collapseToStart()}}}}}}var x=this.currentElement.length;for(var s=0;s<x;s++){if((s+1)!=x){if(this.currentElement[s]&&this.currentElement[s].nextSibling){if(this._isElement(this.currentElement[s],"br")){this.currentElement[this.currentElement.length]=this.currentElement[s].nextSibling}}}}}},saveHTML:function(){var g=this.cleanHTML();if(this._textarea){this.get("element").value=g}else{this.get("element").innerHTML=g}if(this.get("saveEl")!==this.get("element")){var f=this.get("saveEl");if(e.isString(f)){f=d.get(f)}if(f){if(f.tagName.toLowerCase()==="textarea"){f.value=g}else{f.innerHTML=g}}}return g},setEditorHTML:function(g){var f=this._cleanIncomingHTML(g);f=f.replace(/RIGHT_BRACKET/gi,"{");f=f.replace(/LEFT_BRACKET/gi,"}");this._getDoc().body.innerHTML=f;this.nodeChange()},getEditorHTML:function(){try{var f=this._getDoc().body;if(f===null){return null}return this._getDoc().body.innerHTML}catch(g){return""}},show:function(){if(this.browser.gecko){this._setDesignMode("on");this.focus()}if(this.browser.webkit){var f=this;window.setTimeout(function(){f._setInitialContent.call(f)},10)}if(this.currentWindow){this.closeWindow()}this.get("iframe").setStyle("position","static");this.get("iframe").setStyle("left","")},hide:function(){if(this.currentWindow){this.closeWindow()}if(this._fixNodesTimer){clearTimeout(this._fixNodesTimer);this._fixNodesTimer=null}if(this._nodeChangeTimer){clearTimeout(this._nodeChangeTimer);this._nodeChangeTimer=null}this._lastNodeChange=0;this.get("iframe").setStyle("position","absolute");this.get("iframe").setStyle("left","-9999px")},_cleanIncomingHTML:function(f){f=f.replace(/{/gi,"RIGHT_BRACKET");f=f.replace(/}/gi,"LEFT_BRACKET");f=f.replace(/<strong([^>]*)>/gi,"<b$1>");f=f.replace(/<\/strong>/gi,"</b>");f=f.replace(/<embed([^>]*)>/gi,"<YUI_EMBED$1>");f=f.replace(/<\/embed>/gi,"</YUI_EMBED>");f=f.replace(/<em([^>]*)>/gi,"<i$1>");f=f.replace(/<\/em>/gi,"</i>");f=f.replace(/_moz_dirty=""/gi,"");f=f.replace(/<YUI_EMBED([^>]*)>/gi,"<embed$1>");f=f.replace(/<\/YUI_EMBED>/gi,"</embed>");if(this.get("plainText")){f=f.replace(/\n/g,"<br>").replace(/\r/g,"<br>");f=f.replace(/  /gi,"&nbsp;&nbsp;");f=f.replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;")}f=f.replace(/<script([^>]*)>/gi,"<bad>");f=f.replace(/<\/script([^>]*)>/gi,"</bad>");f=f.replace(/&lt;script([^>]*)&gt;/gi,"<bad>");f=f.replace(/&lt;\/script([^>]*)&gt;/gi,"</bad>");f=f.replace(/\r\n/g,"<YUI_LF>").replace(/\n/g,"<YUI_LF>").replace(/\r/g,"<YUI_LF>");f=f.replace(new RegExp("<bad([^>]*)>(.*?)</bad>","gi"),"");f=f.replace(/<YUI_LF>/g,"\n");return f},cleanHTML:function(i){if(!i){i=this.getEditorHTML()}var g=this.get("markup");i=this.pre_filter_linebreaks(i,g);i=this.filter_msword(i);i=i.replace(/<img([^>]*)\/>/gi,"<YUI_IMG$1>");i=i.replace(/<img([^>]*)>/gi,"<YUI_IMG$1>");i=i.replace(/<input([^>]*)\/>/gi,"<YUI_INPUT$1>");i=i.replace(/<input([^>]*)>/gi,"<YUI_INPUT$1>");i=i.replace(/<ul([^>]*)>/gi,"<YUI_UL$1>");i=i.replace(/<\/ul>/gi,"</YUI_UL>");i=i.replace(/<blockquote([^>]*)>/gi,"<YUI_BQ$1>");i=i.replace(/<\/blockquote>/gi,"</YUI_BQ>");i=i.replace(/<embed([^>]*)>/gi,"<YUI_EMBED$1>");i=i.replace(/<\/embed>/gi,"</YUI_EMBED>");if((g=="semantic")||(g=="xhtml")){i=i.replace(/<i(\s+[^>]*)?>/gi,"<em$1>");i=i.replace(/<\/i>/gi,"</em>");i=i.replace(/<b(\s+[^>]*)?>/gi,"<strong$1>");i=i.replace(/<\/b>/gi,"</strong>")}i=i.replace(/_moz_dirty=""/gi,"");i=i.replace(/<strike/gi,'<span style="text-decoration: line-through;"');i=i.replace(/\/strike>/gi,"/span>");if(this.browser.ie){i=i.replace(/text-decoration/gi,"text-decoration");i=i.replace(/font-weight/gi,"font-weight");i=i.replace(/_width="([^>]*)"/gi,"");i=i.replace(/_height="([^>]*)"/gi,"");var h=this._baseHREF.replace(/\//gi,"\\/"),j=new RegExp('src="'+h,"gi");i=i.replace(j,'src="')}i=i.replace(/<font/gi,"<font");i=i.replace(/<\/font>/gi,"</font>");i=i.replace(/<span/gi,"<span");i=i.replace(/<\/span>/gi,"</span>");if((g=="semantic")||(g=="xhtml")||(g=="css")){i=i.replace(new RegExp('<font([^>]*)face="([^>]*)">(.*?)</font>',"gi"),'<span $1 style="font-family: $2;">$3</span>');i=i.replace(/<u/gi,'<span style="text-decoration: underline;"');if(this.browser.webkit){i=i.replace(new RegExp('<span class="Apple-style-span" style="font-weight: bold;">([^>]*)</span>',"gi"),"<strong>$1</strong>");i=i.replace(new RegExp('<span class="Apple-style-span" style="font-style: italic;">([^>]*)</span>',"gi"),"<em>$1</em>")}i=i.replace(/\/u>/gi,"/span>");if(g=="css"){i=i.replace(/<em([^>]*)>/gi,"<i$1>");i=i.replace(/<\/em>/gi,"</i>");i=i.replace(/<strong([^>]*)>/gi,"<b$1>");i=i.replace(/<\/strong>/gi,"</b>");i=i.replace(/<b/gi,'<span style="font-weight: bold;"');i=i.replace(/\/b>/gi,"/span>");i=i.replace(/<i/gi,'<span style="font-style: italic;"');i=i.replace(/\/i>/gi,"/span>")}i=i.replace(/  /gi," ")}else{i=i.replace(/<u/gi,"<u");i=i.replace(/\/u>/gi,"/u>")}i=i.replace(/<ol([^>]*)>/gi,"<ol$1>");i=i.replace(/\/ol>/gi,"/ol>");i=i.replace(/<li/gi,"<li");i=i.replace(/\/li>/gi,"/li>");i=this.filter_safari(i);i=this.filter_internals(i);i=this.filter_all_rgb(i);i=this.post_filter_linebreaks(i,g);if(g=="xhtml"){i=i.replace(/<YUI_IMG([^>]*)>/g,"<img $1 />");i=i.replace(/<YUI_INPUT([^>]*)>/g,"<input $1 />")}else{i=i.replace(/<YUI_IMG([^>]*)>/g,"<img $1>");i=i.replace(/<YUI_INPUT([^>]*)>/g,"<input $1>")}i=i.replace(/<YUI_UL([^>]*)>/g,"<ul$1>");i=i.replace(/<\/YUI_UL>/g,"</ul>");i=i.replace(/<YUI_BQ([^>]*)>/g,"<blockquote$1>");i=i.replace(/<\/YUI_BQ>/g,"</blockquote>");i=i.replace(/<YUI_EMBED([^>]*)>/g,"<embed$1>");i=i.replace(/<\/YUI_EMBED>/g,"</embed>");i=i.replace(/ &amp; /gi," YUI_AMP ");i=i.replace(/ &amp;/gi," YUI_AMP_F ");i=i.replace(/&amp; /gi," YUI_AMP_R ");i=i.replace(/&amp;/gi,"&");i=i.replace(/ YUI_AMP /gi," &amp; ");i=i.replace(/ YUI_AMP_F /gi," &amp;");i=i.replace(/ YUI_AMP_R /gi,"&amp; ");i=YAHOO.lang.trim(i);if(this.get("removeLineBreaks")){i=i.replace(/\n/g,"").replace(/\r/g,"");i=i.replace(/  /gi," ")}for(var f in this.invalidHTML){if(YAHOO.lang.hasOwnProperty(this.invalidHTML,f)){if(e.isObject(f)&&f.keepContents){i=i.replace(new RegExp("<"+f+"([^>]*)>(.*?)</"+f+">","gi"),"$1")}else{i=i.replace(new RegExp("<"+f+"([^>]*)>(.*?)</"+f+">","gi"),"")}}}this.fireEvent("cleanHTML",{type:"cleanHTML",target:this,html:i});return i},filter_msword:function(f){if(!this.get("filterWord")){return f}f=f.replace(/<o:p>\s*<\/o:p>/g,"");f=f.replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;");f=f.replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,"");f=f.replace(/\s*mso-[^:]+:[^;"]+;?/gi,"");f=f.replace(/\s*MARGIN: 0cm 0cm 0pt\s*;/gi,"");f=f.replace(/\s*MARGIN: 0cm 0cm 0pt\s*"/gi,'"');f=f.replace(/\s*TEXT-INDENT: 0cm\s*;/gi,"");f=f.replace(/\s*TEXT-INDENT: 0cm\s*"/gi,'"');f=f.replace(/\s*PAGE-BREAK-BEFORE: [^\s;]+;?"/gi,'"');f=f.replace(/\s*FONT-VARIANT: [^\s;]+;?"/gi,'"');f=f.replace(/\s*tab-stops:[^;"]*;?/gi,"");f=f.replace(/\s*tab-stops:[^"]*/gi,"");f=f.replace(/<\\?\?xml[^>]*>/gi,"");f=f.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3");f=f.replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3");f=f.replace(/<(\w[^>]*) onmouseover="([^\"]*)"([^>]*)/gi,"<$1$3");f=f.replace(/<(\w[^>]*) onmouseout="([^\"]*)"([^>]*)/gi,"<$1$3");return f},filter_invalid_lists:function(f){f=f.replace(/<\/li>\n/gi,"</li>");f=f.replace(/<\/li><ol>/gi,"</li><li><ol>");f=f.replace(/<\/ol>/gi,"</ol></li>");f=f.replace(/<\/ol><\/li>\n/gi,"</ol>");f=f.replace(/<\/li><ul>/gi,"</li><li><ul>");f=f.replace(/<\/ul>/gi,"</ul></li>");f=f.replace(/<\/ul><\/li>\n?/gi,"</ul>");f=f.replace(/<\/li>/gi,"</li>");f=f.replace(/<\/ol>/gi,"</ol>");f=f.replace(/<ol>/gi,"<ol>");f=f.replace(/<ul>/gi,"<ul>");return f},filter_safari:function(f){if(this.browser.webkit){f=f.replace(/<span class="Apple-tab-span" style="white-space:pre">([^>])<\/span>/gi,"&nbsp;&nbsp;&nbsp;&nbsp;");f=f.replace(/Apple-style-span/gi,"");f=f.replace(/style="line-height: normal;"/gi,"");f=f.replace(/yui-wk-div/gi,"");f=f.replace(/yui-wk-p/gi,"");f=f.replace(/<li><\/li>/gi,"");f=f.replace(/<li> <\/li>/gi,"");f=f.replace(/<li>  <\/li>/gi,"");if(this.get("ptags")){f=f.replace(/<div([^>]*)>/g,"<p$1>");f=f.replace(/<\/div>/gi,"</p>")}else{f=f.replace(/<div([^>]*)>([ tnr]*)<\/div>/gi,"<br>");f=f.replace(/<\/div>/gi,"")}}return f},filter_internals:function(f){f=f.replace(/\r/g,"");f=f.replace(/<\/?(body|head|html)[^>]*>/gi,"");f=f.replace(/<YUI_BR><\/li>/gi,"</li>");f=f.replace(/yui-tag-span/gi,"");f=f.replace(/yui-tag/gi,"");f=f.replace(/yui-non/gi,"");f=f.replace(/yui-img/gi,"");f=f.replace(/ tag="span"/gi,"");f=f.replace(/ class=""/gi,"");f=f.replace(/ style=""/gi,"");f=f.replace(/ class=" "/gi,"");f=f.replace(/ class="  "/gi,"");f=f.replace(/ target=""/gi,"");f=f.replace(/ title=""/gi,"");if(this.browser.ie){f=f.replace(/ class= /gi,"");f=f.replace(/ class= >/gi,"")}return f},filter_all_rgb:function(k){var j=new RegExp("rgb\\s*?\\(\\s*?([0-9]+).*?,\\s*?([0-9]+).*?,\\s*?([0-9]+).*?\\)","gi");var f=k.match(j);if(e.isArray(f)){for(var h=0;h<f.length;h++){var g=this.filter_rgb(f[h]);k=k.replace(f[h].toString(),g)}}return k},filter_rgb:function(i){if(i.toLowerCase().indexOf("rgb")!=-1){var l=new RegExp("(.*?)rgb\\s*?\\(\\s*?([0-9]+).*?,\\s*?([0-9]+).*?,\\s*?([0-9]+).*?\\)(.*?)","gi");var h=i.replace(l,"$1,$2,$3,$4,$5").split(",");if(h.length==5){var k=parseInt(h[1],10).toString(16);var j=parseInt(h[2],10).toString(16);var f=parseInt(h[3],10).toString(16);k=k.length==1?"0"+k:k;j=j.length==1?"0"+j:j;f=f.length==1?"0"+f:f;i="#"+k+j+f}}return i},pre_filter_linebreaks:function(g,f){if(this.browser.webkit){g=g.replace(/<br class="khtml-block-placeholder">/gi,"<YUI_BR>");g=g.replace(/<br class="webkit-block-placeholder">/gi,"<YUI_BR>")}g=g.replace(/<br>/gi,"<YUI_BR>");g=g.replace(/<br (.*?)>/gi,"<YUI_BR>");g=g.replace(/<br\/>/gi,"<YUI_BR>");g=g.replace(/<br \/>/gi,"<YUI_BR>");g=g.replace(/<div><YUI_BR><\/div>/gi,"<YUI_BR>");g=g.replace(/<p>(&nbsp;|&#160;)<\/p>/g,"<YUI_BR>");g=g.replace(/<p><br>&nbsp;<\/p>/gi,"<YUI_BR>");g=g.replace(/<p>&nbsp;<\/p>/gi,"<YUI_BR>");g=g.replace(/<YUI_BR>$/,"");g=g.replace(/<YUI_BR><\/p>/g,"</p>");if(this.browser.ie){g=g.replace(/&nbsp;&nbsp;&nbsp;&nbsp;/g,"\t")}return g},post_filter_linebreaks:function(g,f){if(f=="xhtml"){g=g.replace(/<YUI_BR>/g,"<br />")}else{g=g.replace(/<YUI_BR>/g,"<br>")}return g},clearEditorDoc:function(){this._getDoc().body.innerHTML="&nbsp;"},openWindow:function(f){},moveWindow:function(){},_closeWindow:function(){},closeWindow:function(){this.toolbar.resetAllButtons();this.focus()},destroy:function(){if(this._nodeChangeDelayTimer){clearTimeout(this._nodeChangeDelayTimer)}this.hide();if(this.resize){this.resize.destroy()}if(this.dd){this.dd.unreg()}if(this.get("panel")){this.get("panel").destroy()}this.saveHTML();this.toolbar.destroy();this.setStyle("visibility","visible");this.setStyle("position","static");this.setStyle("top","");this.setStyle("left","");var f=this.get("element");this.get("element_cont").get("parentNode").replaceChild(f,this.get("element_cont").get("element"));this.get("element_cont").get("element").innerHTML="";this.set("handleSubmit",false);return true},toString:function(){var f="SimpleEditor";if(this.get&&this.get("element_cont")){f="SimpleEditor (#"+this.get("element_cont").get("id")+")"+((this.get("disabled")?" Disabled":""))}return f}});YAHOO.widget.EditorInfo={_instances:{},blankImage:"",window:{},panel:null,getEditorById:function(f){if(!YAHOO.lang.isString(f)){f=f.id}if(this._instances[f]){return this._instances[f]}return false},saveAll:function(h){var g,j,f=YAHOO.widget.EditorInfo._instances;if(h){for(g in f){if(e.hasOwnProperty(f,g)){j=f[g];if(j.get("element").form&&(j.get("element").form==h)){j.saveHTML()}}}}else{for(g in f){if(e.hasOwnProperty(f,g)){f[g].saveHTML()}}}},toString:function(){var f=0;for(var g in this._instances){if(e.hasOwnProperty(this._instances,g)){f++}}return"Editor Info ("+f+" registered intance"+((f>1)?"s":"")+")"}}})();YAHOO.register("simpleeditor",YAHOO.widget.SimpleEditor,{version:"2.8.0r4",build:"2449"});